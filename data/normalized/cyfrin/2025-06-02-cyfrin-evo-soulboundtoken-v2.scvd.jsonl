{"schema_version": "0.1", "scvd_id": "SCVD-cyfrin_2025-06-02-cyfrin-evo-soulboundtoken-v2.0-001", "doc_id": "cyfrin_2025-06-02-cyfrin-evo-soulboundtoken-v2.0", "finding_index": 1, "page_start": null, "title": "Missing common Chainlink Oracle validations", "short_summary": null, "description_md": "**Description:** The protocol is missing common [Chainlink Oracle validations](https://medium.com/contractlevel/chainlink-oracle-defi-attacks-93b6cb6541bf); it calls `AggregatorV3Interface::latestRoundData` without any validation of the result:\n```solidity\nfunction _getLatestPrice() internal view returns (uint256) {\n    //slither-disable-next-line unused-return\n    (, int256 price,,,) = i_nativeUsdFeed.latestRoundData();\n    return uint256(price);\n}\n```\n", "full_markdown": "### Missing common Chainlink Oracle validations\n\n**Description:** The protocol is missing common [Chainlink Oracle validations](https://medium.com/contractlevel/chainlink-oracle-defi-attacks-93b6cb6541bf); it calls `AggregatorV3Interface::latestRoundData` without any validation of the result:\n```solidity\nfunction _getLatestPrice() internal view returns (uint256) {\n    //slither-disable-next-line unused-return\n    (, int256 price,,,) = i_nativeUsdFeed.latestRoundData();\n    return uint256(price);\n}\n```\n\n**Recommended Mitigation:** Implement common Chainlink oracle validations such as checking for:\n* [stale prices](https://medium.com/contractlevel/chainlink-oracle-defi-attacks-93b6cb6541bf#99af) using the [correct heartbeat](https://medium.com/contractlevel/chainlink-oracle-defi-attacks-93b6cb6541bf#fb78) for the particular oracle\n* [down L2 sequencer](https://medium.com/contractlevel/chainlink-oracle-defi-attacks-93b6cb6541bf#0faf), [revert if `startedAt == 0`](https://solodit.contractlevel.io/issues/insufficient-checks-to-confirm-the-correct-status-of-the-sequenceruptimefeed-codehawks-zaros-git) and potentially a small [grace period](https://docs.chain.link/data-feeds/l2-sequencer-feeds#example-code) of ~2 minutes after it recovers before resuming to fetch price data\n* [returned price not at min or max boundaries](https://medium.com/contractlevel/chainlink-oracle-defi-attacks-93b6cb6541bf#00ac)\n\nFor this protocol the impact of omitting these checks is quite minimal; in a worst-case scenario users are able to buy NFTs for a cheaper or greater price, but there is no threat to protocol solvency/user liquidation etc as can be a threat in other protocols. And since users can only buy 1 NFT and can't sell/transfer, it isn't that big a deal. If these checks are excluded to keep gas costs down perhaps just put a comment noting this.\n\n**Evo:**\nFixed in commits [6af531e](https://github.com/contractlevel/sbt/commit/6af531e49f7d7dd525da449bcdbdacb171e0c70d),[7a06688](https://github.com/contractlevel/sbt/commit/7a0668860f9b4f43798988349a966147bf94f33f), [93021e4](https://github.com/contractlevel/sbt/commit/93021e4f9c2afb40f64f9f9de69661a134702313).\n\n**Cyfrin:** Verified.\n", "sections": {"description_md": "**Description:** The protocol is missing common [Chainlink Oracle validations](https://medium.com/contractlevel/chainlink-oracle-defi-attacks-93b6cb6541bf); it calls `AggregatorV3Interface::latestRoundData` without any validation of the result:\n```solidity\nfunction _getLatestPrice() internal view returns (uint256) {\n    //slither-disable-next-line unused-return\n    (, int256 price,,,) = i_nativeUsdFeed.latestRoundData();\n    return uint256(price);\n}\n```\n", "impact_md": null, "recommendation_md": "**Recommended Mitigation:** Implement common Chainlink oracle validations such as checking for:\n* [stale prices](https://medium.com/contractlevel/chainlink-oracle-defi-attacks-93b6cb6541bf#99af) using the [correct heartbeat](https://medium.com/contractlevel/chainlink-oracle-defi-attacks-93b6cb6541bf#fb78) for the particular oracle\n* [down L2 sequencer](https://medium.com/contractlevel/chainlink-oracle-defi-attacks-93b6cb6541bf#0faf), [revert if `startedAt == 0`](https://solodit.contractlevel.io/issues/insufficient-checks-to-confirm-the-correct-status-of-the-sequenceruptimefeed-codehawks-zaros-git) and potentially a small [grace period](https://docs.chain.link/data-feeds/l2-sequencer-feeds#example-code) of ~2 minutes after it recovers before resuming to fetch price data\n* [returned price not at min or max boundaries](https://medium.com/contractlevel/chainlink-oracle-defi-attacks-93b6cb6541bf#00ac)\n\nFor this protocol the impact of omitting these checks is quite minimal; in a worst-case scenario users are able to buy NFTs for a cheaper or greater price, but there is no threat to protocol solvency/user liquidation etc as can be a threat in other protocols. And since users can only buy 1 NFT and can't sell/transfer, it isn't that big a deal. If these checks are excluded to keep gas costs down perhaps just put a comment noting this.\n", "poc_md": null, "fix_status_md": null, "other_md": "**Evo:**\nFixed in commits [6af531e](https://github.com/contractlevel/sbt/commit/6af531e49f7d7dd525da449bcdbdacb171e0c70d),[7a06688](https://github.com/contractlevel/sbt/commit/7a0668860f9b4f43798988349a966147bf94f33f), [93021e4](https://github.com/contractlevel/sbt/commit/93021e4f9c2afb40f64f9f9de69661a134702313).\n\n**Cyfrin:** Verified.\n", "full_markdown_body": "**Description:** The protocol is missing common [Chainlink Oracle validations](https://medium.com/contractlevel/chainlink-oracle-defi-attacks-93b6cb6541bf); it calls `AggregatorV3Interface::latestRoundData` without any validation of the result:\n```solidity\nfunction _getLatestPrice() internal view returns (uint256) {\n    //slither-disable-next-line unused-return\n    (, int256 price,,,) = i_nativeUsdFeed.latestRoundData();\n    return uint256(price);\n}\n```\n\n**Recommended Mitigation:** Implement common Chainlink oracle validations such as checking for:\n* [stale prices](https://medium.com/contractlevel/chainlink-oracle-defi-attacks-93b6cb6541bf#99af) using the [correct heartbeat](https://medium.com/contractlevel/chainlink-oracle-defi-attacks-93b6cb6541bf#fb78) for the particular oracle\n* [down L2 sequencer](https://medium.com/contractlevel/chainlink-oracle-defi-attacks-93b6cb6541bf#0faf), [revert if `startedAt == 0`](https://solodit.contractlevel.io/issues/insufficient-checks-to-confirm-the-correct-status-of-the-sequenceruptimefeed-codehawks-zaros-git) and potentially a small [grace period](https://docs.chain.link/data-feeds/l2-sequencer-feeds#example-code) of ~2 minutes after it recovers before resuming to fetch price data\n* [returned price not at min or max boundaries](https://medium.com/contractlevel/chainlink-oracle-defi-attacks-93b6cb6541bf#00ac)\n\nFor this protocol the impact of omitting these checks is quite minimal; in a worst-case scenario users are able to buy NFTs for a cheaper or greater price, but there is no threat to protocol solvency/user liquidation etc as can be a threat in other protocols. And since users can only buy 1 NFT and can't sell/transfer, it isn't that big a deal. If these checks are excluded to keep gas costs down perhaps just put a comment noting this.\n\n**Evo:**\nFixed in commits [6af531e](https://github.com/contractlevel/sbt/commit/6af531e49f7d7dd525da449bcdbdacb171e0c70d),[7a06688](https://github.com/contractlevel/sbt/commit/7a0668860f9b4f43798988349a966147bf94f33f), [93021e4](https://github.com/contractlevel/sbt/commit/93021e4f9c2afb40f64f9f9de69661a134702313).\n\n**Cyfrin:** Verified.\n", "markdown_raw": "### Missing common Chainlink Oracle validations\n\n**Description:** The protocol is missing common [Chainlink Oracle validations](https://medium.com/contractlevel/chainlink-oracle-defi-attacks-93b6cb6541bf); it calls `AggregatorV3Interface::latestRoundData` without any validation of the result:\n```solidity\nfunction _getLatestPrice() internal view returns (uint256) {\n    //slither-disable-next-line unused-return\n    (, int256 price,,,) = i_nativeUsdFeed.latestRoundData();\n    return uint256(price);\n}\n```\n\n**Recommended Mitigation:** Implement common Chainlink oracle validations such as checking for:\n* [stale prices](https://medium.com/contractlevel/chainlink-oracle-defi-attacks-93b6cb6541bf#99af) using the [correct heartbeat](https://medium.com/contractlevel/chainlink-oracle-defi-attacks-93b6cb6541bf#fb78) for the particular oracle\n* [down L2 sequencer](https://medium.com/contractlevel/chainlink-oracle-defi-attacks-93b6cb6541bf#0faf), [revert if `startedAt == 0`](https://solodit.contractlevel.io/issues/insufficient-checks-to-confirm-the-correct-status-of-the-sequenceruptimefeed-codehawks-zaros-git) and potentially a small [grace period](https://docs.chain.link/data-feeds/l2-sequencer-feeds#example-code) of ~2 minutes after it recovers before resuming to fetch price data\n* [returned price not at min or max boundaries](https://medium.com/contractlevel/chainlink-oracle-defi-attacks-93b6cb6541bf#00ac)\n\nFor this protocol the impact of omitting these checks is quite minimal; in a worst-case scenario users are able to buy NFTs for a cheaper or greater price, but there is no threat to protocol solvency/user liquidation etc as can be a threat in other protocols. And since users can only buy 1 NFT and can't sell/transfer, it isn't that big a deal. If these checks are excluded to keep gas costs down perhaps just put a comment noting this.\n\n**Evo:**\nFixed in commits [6af531e](https://github.com/contractlevel/sbt/commit/6af531e49f7d7dd525da449bcdbdacb171e0c70d),[7a06688](https://github.com/contractlevel/sbt/commit/7a0668860f9b4f43798988349a966147bf94f33f), [93021e4](https://github.com/contractlevel/sbt/commit/93021e4f9c2afb40f64f9f9de69661a134702313).\n\n**Cyfrin:** Verified.\n"}, "severity": "Low", "difficulty": null, "type": null, "finding_id": null, "target": {"path": null, "language": null, "chain": null, "contract_name": null, "contract_address": null, "function": null, "bytecode_hash": null, "caip_id": null}, "repo": {"url": "https://github.com/contractlevel/sbt", "org": "contractlevel", "name": "sbt", "commit": "6af531e49f7d7dd525da449bcdbdacb171e0c70d", "branch": null, "relative_file": null, "lines": null}, "taxonomy": {"swc": [], "cwe": [], "tags": []}, "status": {"fix_status": null, "fixed_in_commit": null, "fixed_in_pr": [], "exploited_in_the_wild": null, "cvss": null, "bounty_reference": null}, "references": [], "provenance": {"source_pdf": "2025-06-02-cyfrin-evo-soulboundtoken-v2.0.md", "source_mtime": "2025-11-01T12:05:00+00:00", "report_extracted_at": "2025-11-19T09:22:55.614418+00:00", "report_extractor_version": "poc-0.4-md-no-llm", "report_extraction_tool": "marker+qwen3:8b", "scvd_normalized_at": "2025-11-19T09:22:55.615621+00:00", "scvd_normalizer_version": "poc-0.1"}, "metadata_raw": {"Severity": "Low", "Difficulty": null, "Type": null, "Finding ID": null, "Target": null, "Severity_normalized": "Low"}}
{"schema_version": "0.1", "scvd_id": "SCVD-cyfrin_2025-06-02-cyfrin-evo-soulboundtoken-v2.0-002", "doc_id": "cyfrin_2025-06-02-cyfrin-evo-soulboundtoken-v2.0", "finding_index": 2, "page_start": null, "title": "Users who are removed from the blacklist have to pay again for their NFT", "short_summary": null, "description_md": "**Description:** When a user is added to the blacklist, the NFT which they already paid for is burned:\n```solidity\nfunction _addToBlacklist(address account) internal {\n    // *snip: code not relevant *//\n\n    if (balanceOf(account) > 0) {\n        uint256 tokenId = tokenOfOwnerByIndex(account, 0); // Get first token\n        _burn(tokenId); // Burn the token\n    }\n}\n```\n\nBut when they are removed from the blacklist, they do not receive a free NFT to make up for their previously burned one, nor is there any flag set that would enable them to mind their NFT again but without paying a fee:\n```solidity\nfunction _removeFromBlacklist(address account) internal {\n    if (!s_blacklist[account]) revert SoulBoundToken__NotBlacklisted(account);\n\n    s_blacklist[account] = false;\n    emit RemovedFromBlacklist(account);\n}\n```\n", "full_markdown": "### Users who are removed from the blacklist have to pay again for their NFT\n\n**Description:** When a user is added to the blacklist, the NFT which they already paid for is burned:\n```solidity\nfunction _addToBlacklist(address account) internal {\n    // *snip: code not relevant *//\n\n    if (balanceOf(account) > 0) {\n        uint256 tokenId = tokenOfOwnerByIndex(account, 0); // Get first token\n        _burn(tokenId); // Burn the token\n    }\n}\n```\n\nBut when they are removed from the blacklist, they do not receive a free NFT to make up for their previously burned one, nor is there any flag set that would enable them to mind their NFT again but without paying a fee:\n```solidity\nfunction _removeFromBlacklist(address account) internal {\n    if (!s_blacklist[account]) revert SoulBoundToken__NotBlacklisted(account);\n\n    s_blacklist[account] = false;\n    emit RemovedFromBlacklist(account);\n}\n```\n\n**Impact:** A user who bought an NFT, then was blacklisted, then removed from the blacklist will have to pay twice to get the NFT.\n\n**Recommended Mitigation:** This doesn't seem fair; if a user had an NFT burned when they were blacklisted, they should receive a free NFT back if later removed from the blacklist.\n\n**Evo:**\nAcknowledged; in the unlikely case a user is blacklisted due to admin error then subsequently removed from the blacklist, the DAO will compensate the user via a community vote.\n", "sections": {"description_md": "**Description:** When a user is added to the blacklist, the NFT which they already paid for is burned:\n```solidity\nfunction _addToBlacklist(address account) internal {\n    // *snip: code not relevant *//\n\n    if (balanceOf(account) > 0) {\n        uint256 tokenId = tokenOfOwnerByIndex(account, 0); // Get first token\n        _burn(tokenId); // Burn the token\n    }\n}\n```\n\nBut when they are removed from the blacklist, they do not receive a free NFT to make up for their previously burned one, nor is there any flag set that would enable them to mind their NFT again but without paying a fee:\n```solidity\nfunction _removeFromBlacklist(address account) internal {\n    if (!s_blacklist[account]) revert SoulBoundToken__NotBlacklisted(account);\n\n    s_blacklist[account] = false;\n    emit RemovedFromBlacklist(account);\n}\n```\n", "impact_md": "**Impact:** A user who bought an NFT, then was blacklisted, then removed from the blacklist will have to pay twice to get the NFT.\n", "recommendation_md": "**Recommended Mitigation:** This doesn't seem fair; if a user had an NFT burned when they were blacklisted, they should receive a free NFT back if later removed from the blacklist.\n", "poc_md": null, "fix_status_md": null, "other_md": "**Evo:**\nAcknowledged; in the unlikely case a user is blacklisted due to admin error then subsequently removed from the blacklist, the DAO will compensate the user via a community vote.\n", "full_markdown_body": "**Description:** When a user is added to the blacklist, the NFT which they already paid for is burned:\n```solidity\nfunction _addToBlacklist(address account) internal {\n    // *snip: code not relevant *//\n\n    if (balanceOf(account) > 0) {\n        uint256 tokenId = tokenOfOwnerByIndex(account, 0); // Get first token\n        _burn(tokenId); // Burn the token\n    }\n}\n```\n\nBut when they are removed from the blacklist, they do not receive a free NFT to make up for their previously burned one, nor is there any flag set that would enable them to mind their NFT again but without paying a fee:\n```solidity\nfunction _removeFromBlacklist(address account) internal {\n    if (!s_blacklist[account]) revert SoulBoundToken__NotBlacklisted(account);\n\n    s_blacklist[account] = false;\n    emit RemovedFromBlacklist(account);\n}\n```\n\n**Impact:** A user who bought an NFT, then was blacklisted, then removed from the blacklist will have to pay twice to get the NFT.\n\n**Recommended Mitigation:** This doesn't seem fair; if a user had an NFT burned when they were blacklisted, they should receive a free NFT back if later removed from the blacklist.\n\n**Evo:**\nAcknowledged; in the unlikely case a user is blacklisted due to admin error then subsequently removed from the blacklist, the DAO will compensate the user via a community vote.\n", "markdown_raw": "### Users who are removed from the blacklist have to pay again for their NFT\n\n**Description:** When a user is added to the blacklist, the NFT which they already paid for is burned:\n```solidity\nfunction _addToBlacklist(address account) internal {\n    // *snip: code not relevant *//\n\n    if (balanceOf(account) > 0) {\n        uint256 tokenId = tokenOfOwnerByIndex(account, 0); // Get first token\n        _burn(tokenId); // Burn the token\n    }\n}\n```\n\nBut when they are removed from the blacklist, they do not receive a free NFT to make up for their previously burned one, nor is there any flag set that would enable them to mind their NFT again but without paying a fee:\n```solidity\nfunction _removeFromBlacklist(address account) internal {\n    if (!s_blacklist[account]) revert SoulBoundToken__NotBlacklisted(account);\n\n    s_blacklist[account] = false;\n    emit RemovedFromBlacklist(account);\n}\n```\n\n**Impact:** A user who bought an NFT, then was blacklisted, then removed from the blacklist will have to pay twice to get the NFT.\n\n**Recommended Mitigation:** This doesn't seem fair; if a user had an NFT burned when they were blacklisted, they should receive a free NFT back if later removed from the blacklist.\n\n**Evo:**\nAcknowledged; in the unlikely case a user is blacklisted due to admin error then subsequently removed from the blacklist, the DAO will compensate the user via a community vote.\n"}, "severity": "Low", "difficulty": null, "type": null, "finding_id": null, "target": {"path": null, "language": null, "chain": null, "contract_name": null, "contract_address": null, "function": null, "bytecode_hash": null, "caip_id": null}, "repo": {"url": "https://github.com/contractlevel/sbt", "org": "contractlevel", "name": "sbt", "commit": "6af531e49f7d7dd525da449bcdbdacb171e0c70d", "branch": null, "relative_file": null, "lines": null}, "taxonomy": {"swc": [], "cwe": [], "tags": []}, "status": {"fix_status": null, "fixed_in_commit": null, "fixed_in_pr": [], "exploited_in_the_wild": null, "cvss": null, "bounty_reference": null}, "references": [], "provenance": {"source_pdf": "2025-06-02-cyfrin-evo-soulboundtoken-v2.0.md", "source_mtime": "2025-11-01T12:05:00+00:00", "report_extracted_at": "2025-11-19T09:22:55.614418+00:00", "report_extractor_version": "poc-0.4-md-no-llm", "report_extraction_tool": "marker+qwen3:8b", "scvd_normalized_at": "2025-11-19T09:22:55.615621+00:00", "scvd_normalizer_version": "poc-0.1"}, "metadata_raw": {"Severity": "Low", "Difficulty": null, "Type": null, "Finding ID": null, "Target": null, "Severity_normalized": "Low"}}
{"schema_version": "0.1", "scvd_id": "SCVD-cyfrin_2025-06-02-cyfrin-evo-soulboundtoken-v2.0-003", "doc_id": "cyfrin_2025-06-02-cyfrin-evo-soulboundtoken-v2.0", "finding_index": 3, "page_start": null, "title": "Round up fee against users", "short_summary": null, "description_md": "**Description:** Solidity by default rounds down, but generally fees should be rounded up against users. Using Solady's [library](https://github.com/Vectorized/solady/blob/main/src/utils/FixedPointMathLib.sol) is significantly more efficient than OpenZeppelin:\n```solidity\nimport {FixedPointMathLib} from \"@solady/utils/FixedPointMathLib.sol\";\n\nfunction _getFee() internal view returns (uint256 fee) {\n    // read fee factor directly to output variable\n    fee = s_feeFactor;\n\n    // only do extra work if non-zero\n    if(fee != 0) fee = FixedPointMathLib.fullMulDivUp(fee, PRICE_FEED_PRECISION, _getLatestPrice());\n}\n```\n\nA secondary benefit of using the above is eliminating the possibility of revert due to [intermediate multiplication overflow](https://x.com/DevDacian/status/1892529633104396479), though in this code it isn't a real possibility.\n\nIf you don't want to round up against users but want a slightly faster implementation than the default:\n```solidity\nfunction _getFee() internal view returns (uint256 fee) {\n    // read fee factor directly to output variable\n    fee = s_feeFactor;\n\n    // only do extra work if non-zero\n    if(fee != 0) fee = (fee * PRICE_FEED_PRECISION) / _getLatestPrice();\n}\n```\n", "full_markdown": "### Round up fee against users\n\n**Description:** Solidity by default rounds down, but generally fees should be rounded up against users. Using Solady's [library](https://github.com/Vectorized/solady/blob/main/src/utils/FixedPointMathLib.sol) is significantly more efficient than OpenZeppelin:\n```solidity\nimport {FixedPointMathLib} from \"@solady/utils/FixedPointMathLib.sol\";\n\nfunction _getFee() internal view returns (uint256 fee) {\n    // read fee factor directly to output variable\n    fee = s_feeFactor;\n\n    // only do extra work if non-zero\n    if(fee != 0) fee = FixedPointMathLib.fullMulDivUp(fee, PRICE_FEED_PRECISION, _getLatestPrice());\n}\n```\n\nA secondary benefit of using the above is eliminating the possibility of revert due to [intermediate multiplication overflow](https://x.com/DevDacian/status/1892529633104396479), though in this code it isn't a real possibility.\n\nIf you don't want to round up against users but want a slightly faster implementation than the default:\n```solidity\nfunction _getFee() internal view returns (uint256 fee) {\n    // read fee factor directly to output variable\n    fee = s_feeFactor;\n\n    // only do extra work if non-zero\n    if(fee != 0) fee = (fee * PRICE_FEED_PRECISION) / _getLatestPrice();\n}\n```\n\n**Evo:**\nFixed in commit [52c5384](https://github.com/contractlevel/sbt/commit/52c538448fbceb09f27ae657bcecb0c1483eb933).\n\n**Cyfrin:** Verified.\n", "sections": {"description_md": "**Description:** Solidity by default rounds down, but generally fees should be rounded up against users. Using Solady's [library](https://github.com/Vectorized/solady/blob/main/src/utils/FixedPointMathLib.sol) is significantly more efficient than OpenZeppelin:\n```solidity\nimport {FixedPointMathLib} from \"@solady/utils/FixedPointMathLib.sol\";\n\nfunction _getFee() internal view returns (uint256 fee) {\n    // read fee factor directly to output variable\n    fee = s_feeFactor;\n\n    // only do extra work if non-zero\n    if(fee != 0) fee = FixedPointMathLib.fullMulDivUp(fee, PRICE_FEED_PRECISION, _getLatestPrice());\n}\n```\n\nA secondary benefit of using the above is eliminating the possibility of revert due to [intermediate multiplication overflow](https://x.com/DevDacian/status/1892529633104396479), though in this code it isn't a real possibility.\n\nIf you don't want to round up against users but want a slightly faster implementation than the default:\n```solidity\nfunction _getFee() internal view returns (uint256 fee) {\n    // read fee factor directly to output variable\n    fee = s_feeFactor;\n\n    // only do extra work if non-zero\n    if(fee != 0) fee = (fee * PRICE_FEED_PRECISION) / _getLatestPrice();\n}\n```\n", "impact_md": null, "recommendation_md": null, "poc_md": null, "fix_status_md": null, "other_md": "**Evo:**\nFixed in commit [52c5384](https://github.com/contractlevel/sbt/commit/52c538448fbceb09f27ae657bcecb0c1483eb933).\n\n**Cyfrin:** Verified.\n", "full_markdown_body": "**Description:** Solidity by default rounds down, but generally fees should be rounded up against users. Using Solady's [library](https://github.com/Vectorized/solady/blob/main/src/utils/FixedPointMathLib.sol) is significantly more efficient than OpenZeppelin:\n```solidity\nimport {FixedPointMathLib} from \"@solady/utils/FixedPointMathLib.sol\";\n\nfunction _getFee() internal view returns (uint256 fee) {\n    // read fee factor directly to output variable\n    fee = s_feeFactor;\n\n    // only do extra work if non-zero\n    if(fee != 0) fee = FixedPointMathLib.fullMulDivUp(fee, PRICE_FEED_PRECISION, _getLatestPrice());\n}\n```\n\nA secondary benefit of using the above is eliminating the possibility of revert due to [intermediate multiplication overflow](https://x.com/DevDacian/status/1892529633104396479), though in this code it isn't a real possibility.\n\nIf you don't want to round up against users but want a slightly faster implementation than the default:\n```solidity\nfunction _getFee() internal view returns (uint256 fee) {\n    // read fee factor directly to output variable\n    fee = s_feeFactor;\n\n    // only do extra work if non-zero\n    if(fee != 0) fee = (fee * PRICE_FEED_PRECISION) / _getLatestPrice();\n}\n```\n\n**Evo:**\nFixed in commit [52c5384](https://github.com/contractlevel/sbt/commit/52c538448fbceb09f27ae657bcecb0c1483eb933).\n\n**Cyfrin:** Verified.\n", "markdown_raw": "### Round up fee against users\n\n**Description:** Solidity by default rounds down, but generally fees should be rounded up against users. Using Solady's [library](https://github.com/Vectorized/solady/blob/main/src/utils/FixedPointMathLib.sol) is significantly more efficient than OpenZeppelin:\n```solidity\nimport {FixedPointMathLib} from \"@solady/utils/FixedPointMathLib.sol\";\n\nfunction _getFee() internal view returns (uint256 fee) {\n    // read fee factor directly to output variable\n    fee = s_feeFactor;\n\n    // only do extra work if non-zero\n    if(fee != 0) fee = FixedPointMathLib.fullMulDivUp(fee, PRICE_FEED_PRECISION, _getLatestPrice());\n}\n```\n\nA secondary benefit of using the above is eliminating the possibility of revert due to [intermediate multiplication overflow](https://x.com/DevDacian/status/1892529633104396479), though in this code it isn't a real possibility.\n\nIf you don't want to round up against users but want a slightly faster implementation than the default:\n```solidity\nfunction _getFee() internal view returns (uint256 fee) {\n    // read fee factor directly to output variable\n    fee = s_feeFactor;\n\n    // only do extra work if non-zero\n    if(fee != 0) fee = (fee * PRICE_FEED_PRECISION) / _getLatestPrice();\n}\n```\n\n**Evo:**\nFixed in commit [52c5384](https://github.com/contractlevel/sbt/commit/52c538448fbceb09f27ae657bcecb0c1483eb933).\n\n**Cyfrin:** Verified.\n"}, "severity": "Low", "difficulty": null, "type": null, "finding_id": null, "target": {"path": null, "language": null, "chain": null, "contract_name": null, "contract_address": null, "function": null, "bytecode_hash": null, "caip_id": null}, "repo": {"url": "https://github.com/contractlevel/sbt", "org": "contractlevel", "name": "sbt", "commit": "6af531e49f7d7dd525da449bcdbdacb171e0c70d", "branch": null, "relative_file": null, "lines": null}, "taxonomy": {"swc": [], "cwe": [], "tags": []}, "status": {"fix_status": null, "fixed_in_commit": null, "fixed_in_pr": [], "exploited_in_the_wild": null, "cvss": null, "bounty_reference": null}, "references": [], "provenance": {"source_pdf": "2025-06-02-cyfrin-evo-soulboundtoken-v2.0.md", "source_mtime": "2025-11-01T12:05:00+00:00", "report_extracted_at": "2025-11-19T09:22:55.614418+00:00", "report_extractor_version": "poc-0.4-md-no-llm", "report_extraction_tool": "marker+qwen3:8b", "scvd_normalized_at": "2025-11-19T09:22:55.615621+00:00", "scvd_normalizer_version": "poc-0.1"}, "metadata_raw": {"Severity": "Low", "Difficulty": null, "Type": null, "Finding ID": null, "Target": null, "Severity_normalized": "Low"}}
{"schema_version": "0.1", "scvd_id": "SCVD-cyfrin_2025-06-02-cyfrin-evo-soulboundtoken-v2.0-004", "doc_id": "cyfrin_2025-06-02-cyfrin-evo-soulboundtoken-v2.0", "finding_index": 4, "page_start": null, "title": "Whale can buy near-infinite voting power via mintWithTerms", "short_summary": null, "description_md": "**Description:** Since whales can control near-infinite addresses, as long as they have the funds they can buy near-infinite voting power via `mintWithTerms`.\n", "full_markdown": "### Whale can buy near-infinite voting power via `mintWithTerms`\n\n**Description:** Since whales can control near-infinite addresses, as long as they have the funds they can buy near-infinite voting power via `mintWithTerms`.\n\n**Impact:** This could be used seconds before a proposal is due to expire to decide that proposal. Long-term impact is limited however since the admins can blacklist addresses which burn the NFTs.\n\n**Recommended Mitigation:** Implement a snapshot mechanism to capture total and individual user voting power prior to proposals. Consider implementing pausing to prevent users from minting NFTs via `mintWithTerms` since this is the only function which allows \"unlimited mints\".\n\n**Evo:**\nFixed in commit [2fbd2c5](https://github.com/contractlevel/sbt/commit/2fbd2c5379a5f07a8166ec4041f392d867f5bedd) by allowing admins to pause `mintWithTerms`.\n\n**Cyfrin:** Verified.\n", "sections": {"description_md": "**Description:** Since whales can control near-infinite addresses, as long as they have the funds they can buy near-infinite voting power via `mintWithTerms`.\n", "impact_md": "**Impact:** This could be used seconds before a proposal is due to expire to decide that proposal. Long-term impact is limited however since the admins can blacklist addresses which burn the NFTs.\n", "recommendation_md": "**Recommended Mitigation:** Implement a snapshot mechanism to capture total and individual user voting power prior to proposals. Consider implementing pausing to prevent users from minting NFTs via `mintWithTerms` since this is the only function which allows \"unlimited mints\".\n", "poc_md": null, "fix_status_md": null, "other_md": "**Evo:**\nFixed in commit [2fbd2c5](https://github.com/contractlevel/sbt/commit/2fbd2c5379a5f07a8166ec4041f392d867f5bedd) by allowing admins to pause `mintWithTerms`.\n\n**Cyfrin:** Verified.\n", "full_markdown_body": "**Description:** Since whales can control near-infinite addresses, as long as they have the funds they can buy near-infinite voting power via `mintWithTerms`.\n\n**Impact:** This could be used seconds before a proposal is due to expire to decide that proposal. Long-term impact is limited however since the admins can blacklist addresses which burn the NFTs.\n\n**Recommended Mitigation:** Implement a snapshot mechanism to capture total and individual user voting power prior to proposals. Consider implementing pausing to prevent users from minting NFTs via `mintWithTerms` since this is the only function which allows \"unlimited mints\".\n\n**Evo:**\nFixed in commit [2fbd2c5](https://github.com/contractlevel/sbt/commit/2fbd2c5379a5f07a8166ec4041f392d867f5bedd) by allowing admins to pause `mintWithTerms`.\n\n**Cyfrin:** Verified.\n", "markdown_raw": "### Whale can buy near-infinite voting power via `mintWithTerms`\n\n**Description:** Since whales can control near-infinite addresses, as long as they have the funds they can buy near-infinite voting power via `mintWithTerms`.\n\n**Impact:** This could be used seconds before a proposal is due to expire to decide that proposal. Long-term impact is limited however since the admins can blacklist addresses which burn the NFTs.\n\n**Recommended Mitigation:** Implement a snapshot mechanism to capture total and individual user voting power prior to proposals. Consider implementing pausing to prevent users from minting NFTs via `mintWithTerms` since this is the only function which allows \"unlimited mints\".\n\n**Evo:**\nFixed in commit [2fbd2c5](https://github.com/contractlevel/sbt/commit/2fbd2c5379a5f07a8166ec4041f392d867f5bedd) by allowing admins to pause `mintWithTerms`.\n\n**Cyfrin:** Verified.\n"}, "severity": "Low", "difficulty": null, "type": null, "finding_id": null, "target": {"path": null, "language": null, "chain": null, "contract_name": null, "contract_address": null, "function": null, "bytecode_hash": null, "caip_id": null}, "repo": {"url": "https://github.com/contractlevel/sbt", "org": "contractlevel", "name": "sbt", "commit": "6af531e49f7d7dd525da449bcdbdacb171e0c70d", "branch": null, "relative_file": null, "lines": null}, "taxonomy": {"swc": [], "cwe": [], "tags": []}, "status": {"fix_status": null, "fixed_in_commit": null, "fixed_in_pr": [], "exploited_in_the_wild": null, "cvss": null, "bounty_reference": null}, "references": [], "provenance": {"source_pdf": "2025-06-02-cyfrin-evo-soulboundtoken-v2.0.md", "source_mtime": "2025-11-01T12:05:00+00:00", "report_extracted_at": "2025-11-19T09:22:55.614418+00:00", "report_extractor_version": "poc-0.4-md-no-llm", "report_extraction_tool": "marker+qwen3:8b", "scvd_normalized_at": "2025-11-19T09:22:55.615621+00:00", "scvd_normalizer_version": "poc-0.1"}, "metadata_raw": {"Severity": "Low", "Difficulty": null, "Type": null, "Finding ID": null, "Target": null, "Severity_normalized": "Low"}}
{"schema_version": "0.1", "scvd_id": "SCVD-cyfrin_2025-06-02-cyfrin-evo-soulboundtoken-v2.0-005", "doc_id": "cyfrin_2025-06-02-cyfrin-evo-soulboundtoken-v2.0", "finding_index": 5, "page_start": null, "title": "_verifySignature is not compatible with smart contract wallets or other smart accounts", "short_summary": null, "description_md": "**Description:** Support for smart accounts (e.g. [ERC-4337](https://eips.ethereum.org/EIPS/eip-4337)) and other smart contract wallets (e.g. Safe{Wallet}) minting tokens is not currently possible as the signature verification implemented in `_verifySignature` is only able to handle those generated by EOAs. Here, it could be beneficial to support signature verification not just for smart accounts but also other smart contracts that could include multi-sig wallets or any other use case, for example DAOs with their own smart contract infrastructure, to allow other organizations to participate as members.\n\nEOAs upgraded to [ERC-7702](https://eips.ethereum.org/EIPS/eip-7702) accounts are unaffected, but any other smart contract signatures cannot be verified without implementing [ERC-1271](https://eips.ethereum.org/EIPS/eip-1271). However, this adds the additional consideration that for EIP-7702 accounts the code length will be non-zero, so while these accounts can have their signatures verified using EIP-1271, the private key still holds full authority to sign transactions which means that any implementation of a code length check such as in the [OpenZeppelin SignatureChecker library](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/utils/cryptography/SignatureChecker.sol) will need to be slightly modified to continue to allow verification of signatures from these accounts generated using `eth/personal_sign`. Additional discussion can be found [here](https://blog.rhinestone.wtf/unlocking-chain-abstracted-eoas-with-eip-7702-and-irrevocable-signatures-adc820a150ef).\n\nTo support such smart contract signatures, consider falling back to the OpenZeppelin SignatureChecker library function `isValidERC1271SignatureNow` like so:\n\n```diff\n    function _verifySignature(bytes memory signature) internal view returns (bool) {\n        /// @dev compute the message hash: keccak256(termsHash, msg.sender)\n        bytes32 messageHash = keccak256(abi.encodePacked(s_termsHash, msg.sender));\n\n        /// @dev apply Ethereum signed message prefix\n        bytes32 ethSignedMessageHash = MessageHashUtils.toEthSignedMessageHash(messageHash);\n\n        /// @dev attempt to recover the signer\n        //slither-disable-next-line unused-return\n        (address recovered, ECDSA.RecoverError error,) = ECDSA.tryRecover(ethSignedMessageHash, signature);\n\n        /// @dev return false if errors or incorrect signer\n++      if (error == ECDSA.RecoverError.NoError && recovered == msg.sender) return true;\n++      else return SignatureChecker.isValidERC1271SignatureNow(msg.sender, ethSignedMessageHash, signature);\n    }\n```\n", "full_markdown": "### `_verifySignature` is not compatible with smart contract wallets or other smart accounts\n\n**Description:** Support for smart accounts (e.g. [ERC-4337](https://eips.ethereum.org/EIPS/eip-4337)) and other smart contract wallets (e.g. Safe{Wallet}) minting tokens is not currently possible as the signature verification implemented in `_verifySignature` is only able to handle those generated by EOAs. Here, it could be beneficial to support signature verification not just for smart accounts but also other smart contracts that could include multi-sig wallets or any other use case, for example DAOs with their own smart contract infrastructure, to allow other organizations to participate as members.\n\nEOAs upgraded to [ERC-7702](https://eips.ethereum.org/EIPS/eip-7702) accounts are unaffected, but any other smart contract signatures cannot be verified without implementing [ERC-1271](https://eips.ethereum.org/EIPS/eip-1271). However, this adds the additional consideration that for EIP-7702 accounts the code length will be non-zero, so while these accounts can have their signatures verified using EIP-1271, the private key still holds full authority to sign transactions which means that any implementation of a code length check such as in the [OpenZeppelin SignatureChecker library](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/utils/cryptography/SignatureChecker.sol) will need to be slightly modified to continue to allow verification of signatures from these accounts generated using `eth/personal_sign`. Additional discussion can be found [here](https://blog.rhinestone.wtf/unlocking-chain-abstracted-eoas-with-eip-7702-and-irrevocable-signatures-adc820a150ef).\n\nTo support such smart contract signatures, consider falling back to the OpenZeppelin SignatureChecker library function `isValidERC1271SignatureNow` like so:\n\n```diff\n    function _verifySignature(bytes memory signature) internal view returns (bool) {\n        /// @dev compute the message hash: keccak256(termsHash, msg.sender)\n        bytes32 messageHash = keccak256(abi.encodePacked(s_termsHash, msg.sender));\n\n        /// @dev apply Ethereum signed message prefix\n        bytes32 ethSignedMessageHash = MessageHashUtils.toEthSignedMessageHash(messageHash);\n\n        /// @dev attempt to recover the signer\n        //slither-disable-next-line unused-return\n        (address recovered, ECDSA.RecoverError error,) = ECDSA.tryRecover(ethSignedMessageHash, signature);\n\n        /// @dev return false if errors or incorrect signer\n++      if (error == ECDSA.RecoverError.NoError && recovered == msg.sender) return true;\n++      else return SignatureChecker.isValidERC1271SignatureNow(msg.sender, ethSignedMessageHash, signature);\n    }\n```\n\n**Evo:**\nFixed in commit [6d4f41c](https://github.com/contractlevel/sbt/commit/6d4f41ce160e19713bb4a6cafdf1b739df98e027#diff-39790f8feee6ea105eee119137d7c3d881007ed50d9a62590b54ff559f45b27aL511-R514).\n\n**Cyfrin:** Verified.\n\n\\clearpage\n", "sections": {"description_md": "**Description:** Support for smart accounts (e.g. [ERC-4337](https://eips.ethereum.org/EIPS/eip-4337)) and other smart contract wallets (e.g. Safe{Wallet}) minting tokens is not currently possible as the signature verification implemented in `_verifySignature` is only able to handle those generated by EOAs. Here, it could be beneficial to support signature verification not just for smart accounts but also other smart contracts that could include multi-sig wallets or any other use case, for example DAOs with their own smart contract infrastructure, to allow other organizations to participate as members.\n\nEOAs upgraded to [ERC-7702](https://eips.ethereum.org/EIPS/eip-7702) accounts are unaffected, but any other smart contract signatures cannot be verified without implementing [ERC-1271](https://eips.ethereum.org/EIPS/eip-1271). However, this adds the additional consideration that for EIP-7702 accounts the code length will be non-zero, so while these accounts can have their signatures verified using EIP-1271, the private key still holds full authority to sign transactions which means that any implementation of a code length check such as in the [OpenZeppelin SignatureChecker library](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/utils/cryptography/SignatureChecker.sol) will need to be slightly modified to continue to allow verification of signatures from these accounts generated using `eth/personal_sign`. Additional discussion can be found [here](https://blog.rhinestone.wtf/unlocking-chain-abstracted-eoas-with-eip-7702-and-irrevocable-signatures-adc820a150ef).\n\nTo support such smart contract signatures, consider falling back to the OpenZeppelin SignatureChecker library function `isValidERC1271SignatureNow` like so:\n\n```diff\n    function _verifySignature(bytes memory signature) internal view returns (bool) {\n        /// @dev compute the message hash: keccak256(termsHash, msg.sender)\n        bytes32 messageHash = keccak256(abi.encodePacked(s_termsHash, msg.sender));\n\n        /// @dev apply Ethereum signed message prefix\n        bytes32 ethSignedMessageHash = MessageHashUtils.toEthSignedMessageHash(messageHash);\n\n        /// @dev attempt to recover the signer\n        //slither-disable-next-line unused-return\n        (address recovered, ECDSA.RecoverError error,) = ECDSA.tryRecover(ethSignedMessageHash, signature);\n\n        /// @dev return false if errors or incorrect signer\n++      if (error == ECDSA.RecoverError.NoError && recovered == msg.sender) return true;\n++      else return SignatureChecker.isValidERC1271SignatureNow(msg.sender, ethSignedMessageHash, signature);\n    }\n```\n", "impact_md": null, "recommendation_md": null, "poc_md": null, "fix_status_md": null, "other_md": "**Evo:**\nFixed in commit [6d4f41c](https://github.com/contractlevel/sbt/commit/6d4f41ce160e19713bb4a6cafdf1b739df98e027#diff-39790f8feee6ea105eee119137d7c3d881007ed50d9a62590b54ff559f45b27aL511-R514).\n\n**Cyfrin:** Verified.\n\n\\clearpage\n", "full_markdown_body": "**Description:** Support for smart accounts (e.g. [ERC-4337](https://eips.ethereum.org/EIPS/eip-4337)) and other smart contract wallets (e.g. Safe{Wallet}) minting tokens is not currently possible as the signature verification implemented in `_verifySignature` is only able to handle those generated by EOAs. Here, it could be beneficial to support signature verification not just for smart accounts but also other smart contracts that could include multi-sig wallets or any other use case, for example DAOs with their own smart contract infrastructure, to allow other organizations to participate as members.\n\nEOAs upgraded to [ERC-7702](https://eips.ethereum.org/EIPS/eip-7702) accounts are unaffected, but any other smart contract signatures cannot be verified without implementing [ERC-1271](https://eips.ethereum.org/EIPS/eip-1271). However, this adds the additional consideration that for EIP-7702 accounts the code length will be non-zero, so while these accounts can have their signatures verified using EIP-1271, the private key still holds full authority to sign transactions which means that any implementation of a code length check such as in the [OpenZeppelin SignatureChecker library](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/utils/cryptography/SignatureChecker.sol) will need to be slightly modified to continue to allow verification of signatures from these accounts generated using `eth/personal_sign`. Additional discussion can be found [here](https://blog.rhinestone.wtf/unlocking-chain-abstracted-eoas-with-eip-7702-and-irrevocable-signatures-adc820a150ef).\n\nTo support such smart contract signatures, consider falling back to the OpenZeppelin SignatureChecker library function `isValidERC1271SignatureNow` like so:\n\n```diff\n    function _verifySignature(bytes memory signature) internal view returns (bool) {\n        /// @dev compute the message hash: keccak256(termsHash, msg.sender)\n        bytes32 messageHash = keccak256(abi.encodePacked(s_termsHash, msg.sender));\n\n        /// @dev apply Ethereum signed message prefix\n        bytes32 ethSignedMessageHash = MessageHashUtils.toEthSignedMessageHash(messageHash);\n\n        /// @dev attempt to recover the signer\n        //slither-disable-next-line unused-return\n        (address recovered, ECDSA.RecoverError error,) = ECDSA.tryRecover(ethSignedMessageHash, signature);\n\n        /// @dev return false if errors or incorrect signer\n++      if (error == ECDSA.RecoverError.NoError && recovered == msg.sender) return true;\n++      else return SignatureChecker.isValidERC1271SignatureNow(msg.sender, ethSignedMessageHash, signature);\n    }\n```\n\n**Evo:**\nFixed in commit [6d4f41c](https://github.com/contractlevel/sbt/commit/6d4f41ce160e19713bb4a6cafdf1b739df98e027#diff-39790f8feee6ea105eee119137d7c3d881007ed50d9a62590b54ff559f45b27aL511-R514).\n\n**Cyfrin:** Verified.\n\n\\clearpage\n", "markdown_raw": "### `_verifySignature` is not compatible with smart contract wallets or other smart accounts\n\n**Description:** Support for smart accounts (e.g. [ERC-4337](https://eips.ethereum.org/EIPS/eip-4337)) and other smart contract wallets (e.g. Safe{Wallet}) minting tokens is not currently possible as the signature verification implemented in `_verifySignature` is only able to handle those generated by EOAs. Here, it could be beneficial to support signature verification not just for smart accounts but also other smart contracts that could include multi-sig wallets or any other use case, for example DAOs with their own smart contract infrastructure, to allow other organizations to participate as members.\n\nEOAs upgraded to [ERC-7702](https://eips.ethereum.org/EIPS/eip-7702) accounts are unaffected, but any other smart contract signatures cannot be verified without implementing [ERC-1271](https://eips.ethereum.org/EIPS/eip-1271). However, this adds the additional consideration that for EIP-7702 accounts the code length will be non-zero, so while these accounts can have their signatures verified using EIP-1271, the private key still holds full authority to sign transactions which means that any implementation of a code length check such as in the [OpenZeppelin SignatureChecker library](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/utils/cryptography/SignatureChecker.sol) will need to be slightly modified to continue to allow verification of signatures from these accounts generated using `eth/personal_sign`. Additional discussion can be found [here](https://blog.rhinestone.wtf/unlocking-chain-abstracted-eoas-with-eip-7702-and-irrevocable-signatures-adc820a150ef).\n\nTo support such smart contract signatures, consider falling back to the OpenZeppelin SignatureChecker library function `isValidERC1271SignatureNow` like so:\n\n```diff\n    function _verifySignature(bytes memory signature) internal view returns (bool) {\n        /// @dev compute the message hash: keccak256(termsHash, msg.sender)\n        bytes32 messageHash = keccak256(abi.encodePacked(s_termsHash, msg.sender));\n\n        /// @dev apply Ethereum signed message prefix\n        bytes32 ethSignedMessageHash = MessageHashUtils.toEthSignedMessageHash(messageHash);\n\n        /// @dev attempt to recover the signer\n        //slither-disable-next-line unused-return\n        (address recovered, ECDSA.RecoverError error,) = ECDSA.tryRecover(ethSignedMessageHash, signature);\n\n        /// @dev return false if errors or incorrect signer\n++      if (error == ECDSA.RecoverError.NoError && recovered == msg.sender) return true;\n++      else return SignatureChecker.isValidERC1271SignatureNow(msg.sender, ethSignedMessageHash, signature);\n    }\n```\n\n**Evo:**\nFixed in commit [6d4f41c](https://github.com/contractlevel/sbt/commit/6d4f41ce160e19713bb4a6cafdf1b739df98e027#diff-39790f8feee6ea105eee119137d7c3d881007ed50d9a62590b54ff559f45b27aL511-R514).\n\n**Cyfrin:** Verified.\n\n\\clearpage\n"}, "severity": "Low", "difficulty": null, "type": null, "finding_id": null, "target": {"path": null, "language": null, "chain": null, "contract_name": null, "contract_address": null, "function": null, "bytecode_hash": null, "caip_id": null}, "repo": {"url": "https://github.com/contractlevel/sbt", "org": "contractlevel", "name": "sbt", "commit": "6af531e49f7d7dd525da449bcdbdacb171e0c70d", "branch": null, "relative_file": null, "lines": null}, "taxonomy": {"swc": [], "cwe": [], "tags": []}, "status": {"fix_status": null, "fixed_in_commit": null, "fixed_in_pr": [], "exploited_in_the_wild": null, "cvss": null, "bounty_reference": null}, "references": [], "provenance": {"source_pdf": "2025-06-02-cyfrin-evo-soulboundtoken-v2.0.md", "source_mtime": "2025-11-01T12:05:00+00:00", "report_extracted_at": "2025-11-19T09:22:55.614418+00:00", "report_extractor_version": "poc-0.4-md-no-llm", "report_extraction_tool": "marker+qwen3:8b", "scvd_normalized_at": "2025-11-19T09:22:55.615621+00:00", "scvd_normalizer_version": "poc-0.1"}, "metadata_raw": {"Severity": "Low", "Difficulty": null, "Type": null, "Finding ID": null, "Target": null, "Severity_normalized": "Low"}}
{"schema_version": "0.1", "scvd_id": "SCVD-cyfrin_2025-06-02-cyfrin-evo-soulboundtoken-v2.0-006", "doc_id": "cyfrin_2025-06-02-cyfrin-evo-soulboundtoken-v2.0", "finding_index": 6, "page_start": null, "title": "PreferOwnable2Step instead of Ownable", "short_summary": null, "description_md": "**Description:** Prefer [Ownable2Step](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/access/Ownable2Step.sol) instead of `Ownable` for [safer ownership transfer](https://www.rareskills.io/post/openzeppelin-ownable2step).\n", "full_markdown": "### Prefer`Ownable2Step` instead of `Ownable`\n\n**Description:** Prefer [Ownable2Step](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/access/Ownable2Step.sol) instead of `Ownable` for [safer ownership transfer](https://www.rareskills.io/post/openzeppelin-ownable2step).\n\n**Evo:**\nFixed in commit [620120e](https://github.com/contractlevel/sbt/commit/620120ec5a85c3a2dbd1be52af4ee34fe946efbe).\n\n**Cyfrin:** Verified.\n", "sections": {"description_md": "**Description:** Prefer [Ownable2Step](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/access/Ownable2Step.sol) instead of `Ownable` for [safer ownership transfer](https://www.rareskills.io/post/openzeppelin-ownable2step).\n", "impact_md": null, "recommendation_md": null, "poc_md": null, "fix_status_md": null, "other_md": "**Evo:**\nFixed in commit [620120e](https://github.com/contractlevel/sbt/commit/620120ec5a85c3a2dbd1be52af4ee34fe946efbe).\n\n**Cyfrin:** Verified.\n", "full_markdown_body": "**Description:** Prefer [Ownable2Step](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/access/Ownable2Step.sol) instead of `Ownable` for [safer ownership transfer](https://www.rareskills.io/post/openzeppelin-ownable2step).\n\n**Evo:**\nFixed in commit [620120e](https://github.com/contractlevel/sbt/commit/620120ec5a85c3a2dbd1be52af4ee34fe946efbe).\n\n**Cyfrin:** Verified.\n", "markdown_raw": "### Prefer`Ownable2Step` instead of `Ownable`\n\n**Description:** Prefer [Ownable2Step](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/access/Ownable2Step.sol) instead of `Ownable` for [safer ownership transfer](https://www.rareskills.io/post/openzeppelin-ownable2step).\n\n**Evo:**\nFixed in commit [620120e](https://github.com/contractlevel/sbt/commit/620120ec5a85c3a2dbd1be52af4ee34fe946efbe).\n\n**Cyfrin:** Verified.\n"}, "severity": "Informational", "difficulty": null, "type": null, "finding_id": null, "target": {"path": null, "language": null, "chain": null, "contract_name": null, "contract_address": null, "function": null, "bytecode_hash": null, "caip_id": null}, "repo": {"url": "https://github.com/contractlevel/sbt", "org": "contractlevel", "name": "sbt", "commit": "6af531e49f7d7dd525da449bcdbdacb171e0c70d", "branch": null, "relative_file": null, "lines": null}, "taxonomy": {"swc": [], "cwe": [], "tags": []}, "status": {"fix_status": null, "fixed_in_commit": null, "fixed_in_pr": [], "exploited_in_the_wild": null, "cvss": null, "bounty_reference": null}, "references": [], "provenance": {"source_pdf": "2025-06-02-cyfrin-evo-soulboundtoken-v2.0.md", "source_mtime": "2025-11-01T12:05:00+00:00", "report_extracted_at": "2025-11-19T09:22:55.614418+00:00", "report_extractor_version": "poc-0.4-md-no-llm", "report_extraction_tool": "marker+qwen3:8b", "scvd_normalized_at": "2025-11-19T09:22:55.615621+00:00", "scvd_normalizer_version": "poc-0.1"}, "metadata_raw": {"Severity": "Informational", "Difficulty": null, "Type": null, "Finding ID": null, "Target": null, "Severity_normalized": "Informational"}}
{"schema_version": "0.1", "scvd_id": "SCVD-cyfrin_2025-06-02-cyfrin-evo-soulboundtoken-v2.0-007", "doc_id": "cyfrin_2025-06-02-cyfrin-evo-soulboundtoken-v2.0", "finding_index": 7, "page_start": null, "title": "Assuming Chainlink price feed decimals can lead to unintended errors", "short_summary": null, "description_md": "**Description:** In general, Chainlink x/USD price feeds use 8 decimal precision however this is not universally true for example [AMPL/USD](https://etherscan.io/address/0xe20CA8D7546932360e37E9D72c1a47334af57706#readContract#F3) uses 18 decimal precision.\n\nInstead of [assuming Chainlink oracle price precision](https://medium.com/contractlevel/chainlink-oracle-defi-attacks-93b6cb6541bf#87fc), the precision variable could be declared `immutable` and initialized in the constructor via [`AggregatorV3Interface::decimals`](https://docs.chain.link/data-feeds/api-reference#decimals).\n\nIn practice though the price oracle is hard-coded in `script/HelperConfig.s.sol` and does use 8 decimals for on Optimism, so the current configuration will work fine.\n", "full_markdown": "### Assuming Chainlink price feed decimals can lead to unintended errors\n\n**Description:** In general, Chainlink x/USD price feeds use 8 decimal precision however this is not universally true for example [AMPL/USD](https://etherscan.io/address/0xe20CA8D7546932360e37E9D72c1a47334af57706#readContract#F3) uses 18 decimal precision.\n\nInstead of [assuming Chainlink oracle price precision](https://medium.com/contractlevel/chainlink-oracle-defi-attacks-93b6cb6541bf#87fc), the precision variable could be declared `immutable` and initialized in the constructor via [`AggregatorV3Interface::decimals`](https://docs.chain.link/data-feeds/api-reference#decimals).\n\nIn practice though the price oracle is hard-coded in `script/HelperConfig.s.sol` and does use 8 decimals for on Optimism, so the current configuration will work fine.\n\n**Evo:**\nFixed in commit [f594ae0](https://github.com/contractlevel/sbt/commit/f594ae004d4afc80f19e17c0f61d50caa00a4811).\n\n**Cyfrin:** Verified.\n", "sections": {"description_md": "**Description:** In general, Chainlink x/USD price feeds use 8 decimal precision however this is not universally true for example [AMPL/USD](https://etherscan.io/address/0xe20CA8D7546932360e37E9D72c1a47334af57706#readContract#F3) uses 18 decimal precision.\n\nInstead of [assuming Chainlink oracle price precision](https://medium.com/contractlevel/chainlink-oracle-defi-attacks-93b6cb6541bf#87fc), the precision variable could be declared `immutable` and initialized in the constructor via [`AggregatorV3Interface::decimals`](https://docs.chain.link/data-feeds/api-reference#decimals).\n\nIn practice though the price oracle is hard-coded in `script/HelperConfig.s.sol` and does use 8 decimals for on Optimism, so the current configuration will work fine.\n", "impact_md": null, "recommendation_md": null, "poc_md": null, "fix_status_md": null, "other_md": "**Evo:**\nFixed in commit [f594ae0](https://github.com/contractlevel/sbt/commit/f594ae004d4afc80f19e17c0f61d50caa00a4811).\n\n**Cyfrin:** Verified.\n", "full_markdown_body": "**Description:** In general, Chainlink x/USD price feeds use 8 decimal precision however this is not universally true for example [AMPL/USD](https://etherscan.io/address/0xe20CA8D7546932360e37E9D72c1a47334af57706#readContract#F3) uses 18 decimal precision.\n\nInstead of [assuming Chainlink oracle price precision](https://medium.com/contractlevel/chainlink-oracle-defi-attacks-93b6cb6541bf#87fc), the precision variable could be declared `immutable` and initialized in the constructor via [`AggregatorV3Interface::decimals`](https://docs.chain.link/data-feeds/api-reference#decimals).\n\nIn practice though the price oracle is hard-coded in `script/HelperConfig.s.sol` and does use 8 decimals for on Optimism, so the current configuration will work fine.\n\n**Evo:**\nFixed in commit [f594ae0](https://github.com/contractlevel/sbt/commit/f594ae004d4afc80f19e17c0f61d50caa00a4811).\n\n**Cyfrin:** Verified.\n", "markdown_raw": "### Assuming Chainlink price feed decimals can lead to unintended errors\n\n**Description:** In general, Chainlink x/USD price feeds use 8 decimal precision however this is not universally true for example [AMPL/USD](https://etherscan.io/address/0xe20CA8D7546932360e37E9D72c1a47334af57706#readContract#F3) uses 18 decimal precision.\n\nInstead of [assuming Chainlink oracle price precision](https://medium.com/contractlevel/chainlink-oracle-defi-attacks-93b6cb6541bf#87fc), the precision variable could be declared `immutable` and initialized in the constructor via [`AggregatorV3Interface::decimals`](https://docs.chain.link/data-feeds/api-reference#decimals).\n\nIn practice though the price oracle is hard-coded in `script/HelperConfig.s.sol` and does use 8 decimals for on Optimism, so the current configuration will work fine.\n\n**Evo:**\nFixed in commit [f594ae0](https://github.com/contractlevel/sbt/commit/f594ae004d4afc80f19e17c0f61d50caa00a4811).\n\n**Cyfrin:** Verified.\n"}, "severity": "Informational", "difficulty": null, "type": null, "finding_id": null, "target": {"path": null, "language": null, "chain": null, "contract_name": null, "contract_address": null, "function": null, "bytecode_hash": null, "caip_id": null}, "repo": {"url": "https://github.com/contractlevel/sbt", "org": "contractlevel", "name": "sbt", "commit": "6af531e49f7d7dd525da449bcdbdacb171e0c70d", "branch": null, "relative_file": null, "lines": null}, "taxonomy": {"swc": [], "cwe": [], "tags": []}, "status": {"fix_status": null, "fixed_in_commit": null, "fixed_in_pr": [], "exploited_in_the_wild": null, "cvss": null, "bounty_reference": null}, "references": [], "provenance": {"source_pdf": "2025-06-02-cyfrin-evo-soulboundtoken-v2.0.md", "source_mtime": "2025-11-01T12:05:00+00:00", "report_extracted_at": "2025-11-19T09:22:55.614418+00:00", "report_extractor_version": "poc-0.4-md-no-llm", "report_extraction_tool": "marker+qwen3:8b", "scvd_normalized_at": "2025-11-19T09:22:55.615621+00:00", "scvd_normalizer_version": "poc-0.1"}, "metadata_raw": {"Severity": "Informational", "Difficulty": null, "Type": null, "Finding ID": null, "Target": null, "Severity_normalized": "Informational"}}
{"schema_version": "0.1", "scvd_id": "SCVD-cyfrin_2025-06-02-cyfrin-evo-soulboundtoken-v2.0-008", "doc_id": "cyfrin_2025-06-02-cyfrin-evo-soulboundtoken-v2.0", "finding_index": 8, "page_start": null, "title": "Don't initialize to default values", "short_summary": null, "description_md": "**Description:** Don't initialize to default values as Solidity already does this:\n```solidity\nSoulBoundToken.sol\n125:        for (uint256 i = 0; i < admins.length; ++i) {\n162:        for (uint256 i = 0; i < accounts.length; ++i) {\n226:        for (uint256 i = 0; i < accounts.length; ++i) {\n245:        for (uint256 i = 0; i < accounts.length; ++i) {\n270:        for (uint256 i = 0; i < accounts.length; ++i) {\n289:        for (uint256 i = 0; i < accounts.length; ++i) {\n312:        for (uint256 i = 0; i < accounts.length; ++i) {\n```\n", "full_markdown": "### Don't initialize to default values\n\n**Description:** Don't initialize to default values as Solidity already does this:\n```solidity\nSoulBoundToken.sol\n125:        for (uint256 i = 0; i < admins.length; ++i) {\n162:        for (uint256 i = 0; i < accounts.length; ++i) {\n226:        for (uint256 i = 0; i < accounts.length; ++i) {\n245:        for (uint256 i = 0; i < accounts.length; ++i) {\n270:        for (uint256 i = 0; i < accounts.length; ++i) {\n289:        for (uint256 i = 0; i < accounts.length; ++i) {\n312:        for (uint256 i = 0; i < accounts.length; ++i) {\n```\n\n**Evo:**\nFixed in commit [f594ae0](https://github.com/contractlevel/sbt/commit/f594ae004d4afc80f19e17c0f61d50caa00a4811).\n\n**Cyfrin:** Verified.\n", "sections": {"description_md": "**Description:** Don't initialize to default values as Solidity already does this:\n```solidity\nSoulBoundToken.sol\n125:        for (uint256 i = 0; i < admins.length; ++i) {\n162:        for (uint256 i = 0; i < accounts.length; ++i) {\n226:        for (uint256 i = 0; i < accounts.length; ++i) {\n245:        for (uint256 i = 0; i < accounts.length; ++i) {\n270:        for (uint256 i = 0; i < accounts.length; ++i) {\n289:        for (uint256 i = 0; i < accounts.length; ++i) {\n312:        for (uint256 i = 0; i < accounts.length; ++i) {\n```\n", "impact_md": null, "recommendation_md": null, "poc_md": null, "fix_status_md": null, "other_md": "**Evo:**\nFixed in commit [f594ae0](https://github.com/contractlevel/sbt/commit/f594ae004d4afc80f19e17c0f61d50caa00a4811).\n\n**Cyfrin:** Verified.\n", "full_markdown_body": "**Description:** Don't initialize to default values as Solidity already does this:\n```solidity\nSoulBoundToken.sol\n125:        for (uint256 i = 0; i < admins.length; ++i) {\n162:        for (uint256 i = 0; i < accounts.length; ++i) {\n226:        for (uint256 i = 0; i < accounts.length; ++i) {\n245:        for (uint256 i = 0; i < accounts.length; ++i) {\n270:        for (uint256 i = 0; i < accounts.length; ++i) {\n289:        for (uint256 i = 0; i < accounts.length; ++i) {\n312:        for (uint256 i = 0; i < accounts.length; ++i) {\n```\n\n**Evo:**\nFixed in commit [f594ae0](https://github.com/contractlevel/sbt/commit/f594ae004d4afc80f19e17c0f61d50caa00a4811).\n\n**Cyfrin:** Verified.\n", "markdown_raw": "### Don't initialize to default values\n\n**Description:** Don't initialize to default values as Solidity already does this:\n```solidity\nSoulBoundToken.sol\n125:        for (uint256 i = 0; i < admins.length; ++i) {\n162:        for (uint256 i = 0; i < accounts.length; ++i) {\n226:        for (uint256 i = 0; i < accounts.length; ++i) {\n245:        for (uint256 i = 0; i < accounts.length; ++i) {\n270:        for (uint256 i = 0; i < accounts.length; ++i) {\n289:        for (uint256 i = 0; i < accounts.length; ++i) {\n312:        for (uint256 i = 0; i < accounts.length; ++i) {\n```\n\n**Evo:**\nFixed in commit [f594ae0](https://github.com/contractlevel/sbt/commit/f594ae004d4afc80f19e17c0f61d50caa00a4811).\n\n**Cyfrin:** Verified.\n"}, "severity": "Informational", "difficulty": null, "type": null, "finding_id": null, "target": {"path": null, "language": null, "chain": null, "contract_name": null, "contract_address": null, "function": null, "bytecode_hash": null, "caip_id": null}, "repo": {"url": "https://github.com/contractlevel/sbt", "org": "contractlevel", "name": "sbt", "commit": "6af531e49f7d7dd525da449bcdbdacb171e0c70d", "branch": null, "relative_file": null, "lines": null}, "taxonomy": {"swc": [], "cwe": [], "tags": []}, "status": {"fix_status": null, "fixed_in_commit": null, "fixed_in_pr": [], "exploited_in_the_wild": null, "cvss": null, "bounty_reference": null}, "references": [], "provenance": {"source_pdf": "2025-06-02-cyfrin-evo-soulboundtoken-v2.0.md", "source_mtime": "2025-11-01T12:05:00+00:00", "report_extracted_at": "2025-11-19T09:22:55.614418+00:00", "report_extractor_version": "poc-0.4-md-no-llm", "report_extraction_tool": "marker+qwen3:8b", "scvd_normalized_at": "2025-11-19T09:22:55.615621+00:00", "scvd_normalizer_version": "poc-0.1"}, "metadata_raw": {"Severity": "Informational", "Difficulty": null, "Type": null, "Finding ID": null, "Target": null, "Severity_normalized": "Informational"}}
{"schema_version": "0.1", "scvd_id": "SCVD-cyfrin_2025-06-02-cyfrin-evo-soulboundtoken-v2.0-009", "doc_id": "cyfrin_2025-06-02-cyfrin-evo-soulboundtoken-v2.0", "finding_index": 9, "page_start": null, "title": "Remove obsolete return statements when already using named returns", "short_summary": null, "description_md": "**Description:** Remove obsolete `return` statements when already using named returns:\n```diff\n    function _mintSoulBoundToken(address account) internal returns (uint256 tokenId) {\n        tokenId = _incrementTokenIdCounter(1);\n        _safeMint(account, tokenId);\n-       return tokenId;\n    }\n\n    function _incrementTokenIdCounter(uint256 count) internal returns (uint256 startId) {\n        startId = s_tokenIdCounter;\n        s_tokenIdCounter += count;\n-       return startId;\n    }\n```\n", "full_markdown": "### Remove obsolete `return` statements when already using named returns\n\n**Description:** Remove obsolete `return` statements when already using named returns:\n```diff\n    function _mintSoulBoundToken(address account) internal returns (uint256 tokenId) {\n        tokenId = _incrementTokenIdCounter(1);\n        _safeMint(account, tokenId);\n-       return tokenId;\n    }\n\n    function _incrementTokenIdCounter(uint256 count) internal returns (uint256 startId) {\n        startId = s_tokenIdCounter;\n        s_tokenIdCounter += count;\n-       return startId;\n    }\n```\n\n**Evo:**\nFixed in commit [f594ae0](https://github.com/contractlevel/sbt/commit/f594ae004d4afc80f19e17c0f61d50caa00a4811).\n\n**Cyfrin:** Verified.\n", "sections": {"description_md": "**Description:** Remove obsolete `return` statements when already using named returns:\n```diff\n    function _mintSoulBoundToken(address account) internal returns (uint256 tokenId) {\n        tokenId = _incrementTokenIdCounter(1);\n        _safeMint(account, tokenId);\n-       return tokenId;\n    }\n\n    function _incrementTokenIdCounter(uint256 count) internal returns (uint256 startId) {\n        startId = s_tokenIdCounter;\n        s_tokenIdCounter += count;\n-       return startId;\n    }\n```\n", "impact_md": null, "recommendation_md": null, "poc_md": null, "fix_status_md": null, "other_md": "**Evo:**\nFixed in commit [f594ae0](https://github.com/contractlevel/sbt/commit/f594ae004d4afc80f19e17c0f61d50caa00a4811).\n\n**Cyfrin:** Verified.\n", "full_markdown_body": "**Description:** Remove obsolete `return` statements when already using named returns:\n```diff\n    function _mintSoulBoundToken(address account) internal returns (uint256 tokenId) {\n        tokenId = _incrementTokenIdCounter(1);\n        _safeMint(account, tokenId);\n-       return tokenId;\n    }\n\n    function _incrementTokenIdCounter(uint256 count) internal returns (uint256 startId) {\n        startId = s_tokenIdCounter;\n        s_tokenIdCounter += count;\n-       return startId;\n    }\n```\n\n**Evo:**\nFixed in commit [f594ae0](https://github.com/contractlevel/sbt/commit/f594ae004d4afc80f19e17c0f61d50caa00a4811).\n\n**Cyfrin:** Verified.\n", "markdown_raw": "### Remove obsolete `return` statements when already using named returns\n\n**Description:** Remove obsolete `return` statements when already using named returns:\n```diff\n    function _mintSoulBoundToken(address account) internal returns (uint256 tokenId) {\n        tokenId = _incrementTokenIdCounter(1);\n        _safeMint(account, tokenId);\n-       return tokenId;\n    }\n\n    function _incrementTokenIdCounter(uint256 count) internal returns (uint256 startId) {\n        startId = s_tokenIdCounter;\n        s_tokenIdCounter += count;\n-       return startId;\n    }\n```\n\n**Evo:**\nFixed in commit [f594ae0](https://github.com/contractlevel/sbt/commit/f594ae004d4afc80f19e17c0f61d50caa00a4811).\n\n**Cyfrin:** Verified.\n"}, "severity": "Informational", "difficulty": null, "type": null, "finding_id": null, "target": {"path": null, "language": null, "chain": null, "contract_name": null, "contract_address": null, "function": null, "bytecode_hash": null, "caip_id": null}, "repo": {"url": "https://github.com/contractlevel/sbt", "org": "contractlevel", "name": "sbt", "commit": "6af531e49f7d7dd525da449bcdbdacb171e0c70d", "branch": null, "relative_file": null, "lines": null}, "taxonomy": {"swc": [], "cwe": [], "tags": []}, "status": {"fix_status": null, "fixed_in_commit": null, "fixed_in_pr": [], "exploited_in_the_wild": null, "cvss": null, "bounty_reference": null}, "references": [], "provenance": {"source_pdf": "2025-06-02-cyfrin-evo-soulboundtoken-v2.0.md", "source_mtime": "2025-11-01T12:05:00+00:00", "report_extracted_at": "2025-11-19T09:22:55.614418+00:00", "report_extractor_version": "poc-0.4-md-no-llm", "report_extraction_tool": "marker+qwen3:8b", "scvd_normalized_at": "2025-11-19T09:22:55.615621+00:00", "scvd_normalizer_version": "poc-0.1"}, "metadata_raw": {"Severity": "Informational", "Difficulty": null, "Type": null, "Finding ID": null, "Target": null, "Severity_normalized": "Informational"}}
{"schema_version": "0.1", "scvd_id": "SCVD-cyfrin_2025-06-02-cyfrin-evo-soulboundtoken-v2.0-010", "doc_id": "cyfrin_2025-06-02-cyfrin-evo-soulboundtoken-v2.0", "finding_index": 10, "page_start": null, "title": "Consider preventing users from over-paying", "short_summary": null, "description_md": "**Description:** Currently the protocol allows users to over-pay:\n```solidity\nfunction _revertIfInsufficientFee() internal view {\n    if (msg.value < _getFee()) revert SoulBoundToken__InsufficientFee();\n}\n```\n\nConsider changing this to require the exact fee to prevent users from accidentally over-paying:\n```solidity\nfunction _revertIfIncorrectFee() internal view {\n    if (msg.value != _getFee()) revert SoulBoundToken__IncorrectFee();\n}\n```\n\n[Fat Finger](https://en.wikipedia.org/wiki/Fat-finger_error) errors have previously resulted in notorious unintended errors in financial markets; the protocol could choose to be defensive and help protect users from themselves.\n", "full_markdown": "### Consider preventing users from over-paying\n\n**Description:** Currently the protocol allows users to over-pay:\n```solidity\nfunction _revertIfInsufficientFee() internal view {\n    if (msg.value < _getFee()) revert SoulBoundToken__InsufficientFee();\n}\n```\n\nConsider changing this to require the exact fee to prevent users from accidentally over-paying:\n```solidity\nfunction _revertIfIncorrectFee() internal view {\n    if (msg.value != _getFee()) revert SoulBoundToken__IncorrectFee();\n}\n```\n\n[Fat Finger](https://en.wikipedia.org/wiki/Fat-finger_error) errors have previously resulted in notorious unintended errors in financial markets; the protocol could choose to be defensive and help protect users from themselves.\n\n**Evo:**\nFixed in commit [e3b2f74](https://github.com/contractlevel/sbt/commit/e3b2f74239601b2721118e11aaa92b42dbb502e9).\n\n**Cyfrin:** Verified.\n", "sections": {"description_md": "**Description:** Currently the protocol allows users to over-pay:\n```solidity\nfunction _revertIfInsufficientFee() internal view {\n    if (msg.value < _getFee()) revert SoulBoundToken__InsufficientFee();\n}\n```\n\nConsider changing this to require the exact fee to prevent users from accidentally over-paying:\n```solidity\nfunction _revertIfIncorrectFee() internal view {\n    if (msg.value != _getFee()) revert SoulBoundToken__IncorrectFee();\n}\n```\n\n[Fat Finger](https://en.wikipedia.org/wiki/Fat-finger_error) errors have previously resulted in notorious unintended errors in financial markets; the protocol could choose to be defensive and help protect users from themselves.\n", "impact_md": null, "recommendation_md": null, "poc_md": null, "fix_status_md": null, "other_md": "**Evo:**\nFixed in commit [e3b2f74](https://github.com/contractlevel/sbt/commit/e3b2f74239601b2721118e11aaa92b42dbb502e9).\n\n**Cyfrin:** Verified.\n", "full_markdown_body": "**Description:** Currently the protocol allows users to over-pay:\n```solidity\nfunction _revertIfInsufficientFee() internal view {\n    if (msg.value < _getFee()) revert SoulBoundToken__InsufficientFee();\n}\n```\n\nConsider changing this to require the exact fee to prevent users from accidentally over-paying:\n```solidity\nfunction _revertIfIncorrectFee() internal view {\n    if (msg.value != _getFee()) revert SoulBoundToken__IncorrectFee();\n}\n```\n\n[Fat Finger](https://en.wikipedia.org/wiki/Fat-finger_error) errors have previously resulted in notorious unintended errors in financial markets; the protocol could choose to be defensive and help protect users from themselves.\n\n**Evo:**\nFixed in commit [e3b2f74](https://github.com/contractlevel/sbt/commit/e3b2f74239601b2721118e11aaa92b42dbb502e9).\n\n**Cyfrin:** Verified.\n", "markdown_raw": "### Consider preventing users from over-paying\n\n**Description:** Currently the protocol allows users to over-pay:\n```solidity\nfunction _revertIfInsufficientFee() internal view {\n    if (msg.value < _getFee()) revert SoulBoundToken__InsufficientFee();\n}\n```\n\nConsider changing this to require the exact fee to prevent users from accidentally over-paying:\n```solidity\nfunction _revertIfIncorrectFee() internal view {\n    if (msg.value != _getFee()) revert SoulBoundToken__IncorrectFee();\n}\n```\n\n[Fat Finger](https://en.wikipedia.org/wiki/Fat-finger_error) errors have previously resulted in notorious unintended errors in financial markets; the protocol could choose to be defensive and help protect users from themselves.\n\n**Evo:**\nFixed in commit [e3b2f74](https://github.com/contractlevel/sbt/commit/e3b2f74239601b2721118e11aaa92b42dbb502e9).\n\n**Cyfrin:** Verified.\n"}, "severity": "Informational", "difficulty": null, "type": null, "finding_id": null, "target": {"path": null, "language": null, "chain": null, "contract_name": null, "contract_address": null, "function": null, "bytecode_hash": null, "caip_id": null}, "repo": {"url": "https://github.com/contractlevel/sbt", "org": "contractlevel", "name": "sbt", "commit": "6af531e49f7d7dd525da449bcdbdacb171e0c70d", "branch": null, "relative_file": null, "lines": null}, "taxonomy": {"swc": [], "cwe": [], "tags": []}, "status": {"fix_status": null, "fixed_in_commit": null, "fixed_in_pr": [], "exploited_in_the_wild": null, "cvss": null, "bounty_reference": null}, "references": [], "provenance": {"source_pdf": "2025-06-02-cyfrin-evo-soulboundtoken-v2.0.md", "source_mtime": "2025-11-01T12:05:00+00:00", "report_extracted_at": "2025-11-19T09:22:55.614418+00:00", "report_extractor_version": "poc-0.4-md-no-llm", "report_extraction_tool": "marker+qwen3:8b", "scvd_normalized_at": "2025-11-19T09:22:55.615621+00:00", "scvd_normalizer_version": "poc-0.1"}, "metadata_raw": {"Severity": "Informational", "Difficulty": null, "Type": null, "Finding ID": null, "Target": null, "Severity_normalized": "Informational"}}
{"schema_version": "0.1", "scvd_id": "SCVD-cyfrin_2025-06-02-cyfrin-evo-soulboundtoken-v2.0-011", "doc_id": "cyfrin_2025-06-02-cyfrin-evo-soulboundtoken-v2.0", "finding_index": 11, "page_start": null, "title": "else can be omitted in mintWithTerms", "short_summary": null, "description_md": "**Description:** `else` can be omitted in `mintWithTerms` since if signature validation failed a revert will occur:\n```diff\n        if (!_verifySignature(signature)) revert SoulBoundToken__InvalidSignature();\n-       else emit SignatureVerified(msg.sender, signature);\n+       emit SignatureVerified(msg.sender, signature);\n        tokenId = _mintSoulBoundToken(msg.sender);\n```\n", "full_markdown": "### `else` can be omitted in `mintWithTerms`\n\n**Description:** `else` can be omitted in `mintWithTerms` since if signature validation failed a revert will occur:\n```diff\n        if (!_verifySignature(signature)) revert SoulBoundToken__InvalidSignature();\n-       else emit SignatureVerified(msg.sender, signature);\n+       emit SignatureVerified(msg.sender, signature);\n        tokenId = _mintSoulBoundToken(msg.sender);\n```\n\n**Evo:**\nFixed in commit [e3b2f74](https://github.com/contractlevel/sbt/commit/e3b2f74239601b2721118e11aaa92b42dbb502e9).\n\n**Cyfrin:** Verified.\n\n\\clearpage\n", "sections": {"description_md": "**Description:** `else` can be omitted in `mintWithTerms` since if signature validation failed a revert will occur:\n```diff\n        if (!_verifySignature(signature)) revert SoulBoundToken__InvalidSignature();\n-       else emit SignatureVerified(msg.sender, signature);\n+       emit SignatureVerified(msg.sender, signature);\n        tokenId = _mintSoulBoundToken(msg.sender);\n```\n", "impact_md": null, "recommendation_md": null, "poc_md": null, "fix_status_md": null, "other_md": "**Evo:**\nFixed in commit [e3b2f74](https://github.com/contractlevel/sbt/commit/e3b2f74239601b2721118e11aaa92b42dbb502e9).\n\n**Cyfrin:** Verified.\n\n\\clearpage\n", "full_markdown_body": "**Description:** `else` can be omitted in `mintWithTerms` since if signature validation failed a revert will occur:\n```diff\n        if (!_verifySignature(signature)) revert SoulBoundToken__InvalidSignature();\n-       else emit SignatureVerified(msg.sender, signature);\n+       emit SignatureVerified(msg.sender, signature);\n        tokenId = _mintSoulBoundToken(msg.sender);\n```\n\n**Evo:**\nFixed in commit [e3b2f74](https://github.com/contractlevel/sbt/commit/e3b2f74239601b2721118e11aaa92b42dbb502e9).\n\n**Cyfrin:** Verified.\n\n\\clearpage\n", "markdown_raw": "### `else` can be omitted in `mintWithTerms`\n\n**Description:** `else` can be omitted in `mintWithTerms` since if signature validation failed a revert will occur:\n```diff\n        if (!_verifySignature(signature)) revert SoulBoundToken__InvalidSignature();\n-       else emit SignatureVerified(msg.sender, signature);\n+       emit SignatureVerified(msg.sender, signature);\n        tokenId = _mintSoulBoundToken(msg.sender);\n```\n\n**Evo:**\nFixed in commit [e3b2f74](https://github.com/contractlevel/sbt/commit/e3b2f74239601b2721118e11aaa92b42dbb502e9).\n\n**Cyfrin:** Verified.\n\n\\clearpage\n"}, "severity": "Informational", "difficulty": null, "type": null, "finding_id": null, "target": {"path": null, "language": null, "chain": null, "contract_name": null, "contract_address": null, "function": null, "bytecode_hash": null, "caip_id": null}, "repo": {"url": "https://github.com/contractlevel/sbt", "org": "contractlevel", "name": "sbt", "commit": "6af531e49f7d7dd525da449bcdbdacb171e0c70d", "branch": null, "relative_file": null, "lines": null}, "taxonomy": {"swc": [], "cwe": [], "tags": []}, "status": {"fix_status": null, "fixed_in_commit": null, "fixed_in_pr": [], "exploited_in_the_wild": null, "cvss": null, "bounty_reference": null}, "references": [], "provenance": {"source_pdf": "2025-06-02-cyfrin-evo-soulboundtoken-v2.0.md", "source_mtime": "2025-11-01T12:05:00+00:00", "report_extracted_at": "2025-11-19T09:22:55.614418+00:00", "report_extractor_version": "poc-0.4-md-no-llm", "report_extraction_tool": "marker+qwen3:8b", "scvd_normalized_at": "2025-11-19T09:22:55.615621+00:00", "scvd_normalizer_version": "poc-0.1"}, "metadata_raw": {"Severity": "Informational", "Difficulty": null, "Type": null, "Finding ID": null, "Target": null, "Severity_normalized": "Informational"}}
{"schema_version": "0.1", "scvd_id": "SCVD-cyfrin_2025-06-02-cyfrin-evo-soulboundtoken-v2.0-012", "doc_id": "cyfrin_2025-06-02-cyfrin-evo-soulboundtoken-v2.0", "finding_index": 12, "page_start": null, "title": "Use named returns where this can eliminate local function variables and for memory returns", "short_summary": null, "description_md": "**Description:** Using named returns is more gas efficient where this can eliminate local function variables and for `memory` returns:\n```diff\n-   function batchMintAsAdmin(address[] calldata accounts) external onlyAdmin returns (uint256[] memory) {\n+   function batchMintAsAdmin(address[] calldata accounts) external onlyAdmin returns (uint256[] memory tokenIds) {\n        _revertIfEmptyArray(accounts);\n        uint256 startId = _incrementTokenIdCounter(accounts.length);\n\n-      uint256[] memory tokenIds = new uint256[](accounts.length);\n+      tokenIds = new uint256[](accounts.length);\n        for (uint256 i = 0; i < accounts.length; ++i) {\n            _mintAsAdminChecks(accounts[i]);\n            tokenIds[i] = startId + i;\n            _safeMint(accounts[i], tokenIds[i]);\n        }\n-      return tokenIds;\n    }\n```\n\nGas Result:\n```diff\n{\n-  \"batchMintAsAdmin\": \"252114\"\n+  \"batchMintAsAdmin\": \"252102\"\n}\n```\n", "full_markdown": "### Use named returns where this can eliminate local function variables and for `memory` returns\n\n**Description:** Using named returns is more gas efficient where this can eliminate local function variables and for `memory` returns:\n```diff\n-   function batchMintAsAdmin(address[] calldata accounts) external onlyAdmin returns (uint256[] memory) {\n+   function batchMintAsAdmin(address[] calldata accounts) external onlyAdmin returns (uint256[] memory tokenIds) {\n        _revertIfEmptyArray(accounts);\n        uint256 startId = _incrementTokenIdCounter(accounts.length);\n\n-      uint256[] memory tokenIds = new uint256[](accounts.length);\n+      tokenIds = new uint256[](accounts.length);\n        for (uint256 i = 0; i < accounts.length; ++i) {\n            _mintAsAdminChecks(accounts[i]);\n            tokenIds[i] = startId + i;\n            _safeMint(accounts[i], tokenIds[i]);\n        }\n-      return tokenIds;\n    }\n```\n\nGas Result:\n```diff\n{\n-  \"batchMintAsAdmin\": \"252114\"\n+  \"batchMintAsAdmin\": \"252102\"\n}\n```\n\n**Evo:**\nFixed in commit [b4fcadb](https://github.com/contractlevel/sbt/commit/b4fcadbd9c5684cc4e3b1ee3c39f72c406aaf658).\n\n**Cyfrin:** Verified.\n", "sections": {"description_md": "**Description:** Using named returns is more gas efficient where this can eliminate local function variables and for `memory` returns:\n```diff\n-   function batchMintAsAdmin(address[] calldata accounts) external onlyAdmin returns (uint256[] memory) {\n+   function batchMintAsAdmin(address[] calldata accounts) external onlyAdmin returns (uint256[] memory tokenIds) {\n        _revertIfEmptyArray(accounts);\n        uint256 startId = _incrementTokenIdCounter(accounts.length);\n\n-      uint256[] memory tokenIds = new uint256[](accounts.length);\n+      tokenIds = new uint256[](accounts.length);\n        for (uint256 i = 0; i < accounts.length; ++i) {\n            _mintAsAdminChecks(accounts[i]);\n            tokenIds[i] = startId + i;\n            _safeMint(accounts[i], tokenIds[i]);\n        }\n-      return tokenIds;\n    }\n```\n\nGas Result:\n```diff\n{\n-  \"batchMintAsAdmin\": \"252114\"\n+  \"batchMintAsAdmin\": \"252102\"\n}\n```\n", "impact_md": null, "recommendation_md": null, "poc_md": null, "fix_status_md": null, "other_md": "**Evo:**\nFixed in commit [b4fcadb](https://github.com/contractlevel/sbt/commit/b4fcadbd9c5684cc4e3b1ee3c39f72c406aaf658).\n\n**Cyfrin:** Verified.\n", "full_markdown_body": "**Description:** Using named returns is more gas efficient where this can eliminate local function variables and for `memory` returns:\n```diff\n-   function batchMintAsAdmin(address[] calldata accounts) external onlyAdmin returns (uint256[] memory) {\n+   function batchMintAsAdmin(address[] calldata accounts) external onlyAdmin returns (uint256[] memory tokenIds) {\n        _revertIfEmptyArray(accounts);\n        uint256 startId = _incrementTokenIdCounter(accounts.length);\n\n-      uint256[] memory tokenIds = new uint256[](accounts.length);\n+      tokenIds = new uint256[](accounts.length);\n        for (uint256 i = 0; i < accounts.length; ++i) {\n            _mintAsAdminChecks(accounts[i]);\n            tokenIds[i] = startId + i;\n            _safeMint(accounts[i], tokenIds[i]);\n        }\n-      return tokenIds;\n    }\n```\n\nGas Result:\n```diff\n{\n-  \"batchMintAsAdmin\": \"252114\"\n+  \"batchMintAsAdmin\": \"252102\"\n}\n```\n\n**Evo:**\nFixed in commit [b4fcadb](https://github.com/contractlevel/sbt/commit/b4fcadbd9c5684cc4e3b1ee3c39f72c406aaf658).\n\n**Cyfrin:** Verified.\n", "markdown_raw": "### Use named returns where this can eliminate local function variables and for `memory` returns\n\n**Description:** Using named returns is more gas efficient where this can eliminate local function variables and for `memory` returns:\n```diff\n-   function batchMintAsAdmin(address[] calldata accounts) external onlyAdmin returns (uint256[] memory) {\n+   function batchMintAsAdmin(address[] calldata accounts) external onlyAdmin returns (uint256[] memory tokenIds) {\n        _revertIfEmptyArray(accounts);\n        uint256 startId = _incrementTokenIdCounter(accounts.length);\n\n-      uint256[] memory tokenIds = new uint256[](accounts.length);\n+      tokenIds = new uint256[](accounts.length);\n        for (uint256 i = 0; i < accounts.length; ++i) {\n            _mintAsAdminChecks(accounts[i]);\n            tokenIds[i] = startId + i;\n            _safeMint(accounts[i], tokenIds[i]);\n        }\n-      return tokenIds;\n    }\n```\n\nGas Result:\n```diff\n{\n-  \"batchMintAsAdmin\": \"252114\"\n+  \"batchMintAsAdmin\": \"252102\"\n}\n```\n\n**Evo:**\nFixed in commit [b4fcadb](https://github.com/contractlevel/sbt/commit/b4fcadbd9c5684cc4e3b1ee3c39f72c406aaf658).\n\n**Cyfrin:** Verified.\n"}, "severity": null, "difficulty": null, "type": null, "finding_id": null, "target": {"path": null, "language": null, "chain": null, "contract_name": null, "contract_address": null, "function": null, "bytecode_hash": null, "caip_id": null}, "repo": {"url": "https://github.com/contractlevel/sbt", "org": "contractlevel", "name": "sbt", "commit": "6af531e49f7d7dd525da449bcdbdacb171e0c70d", "branch": null, "relative_file": null, "lines": null}, "taxonomy": {"swc": [], "cwe": [], "tags": []}, "status": {"fix_status": null, "fixed_in_commit": null, "fixed_in_pr": [], "exploited_in_the_wild": null, "cvss": null, "bounty_reference": null}, "references": [], "provenance": {"source_pdf": "2025-06-02-cyfrin-evo-soulboundtoken-v2.0.md", "source_mtime": "2025-11-01T12:05:00+00:00", "report_extracted_at": "2025-11-19T09:22:55.614418+00:00", "report_extractor_version": "poc-0.4-md-no-llm", "report_extraction_tool": "marker+qwen3:8b", "scvd_normalized_at": "2025-11-19T09:22:55.615621+00:00", "scvd_normalizer_version": "poc-0.1"}, "metadata_raw": {"Severity": "Gas", "Difficulty": null, "Type": null, "Finding ID": null, "Target": null, "Severity_normalized": null}}
{"schema_version": "0.1", "scvd_id": "SCVD-cyfrin_2025-06-02-cyfrin-evo-soulboundtoken-v2.0-013", "doc_id": "cyfrin_2025-06-02-cyfrin-evo-soulboundtoken-v2.0", "finding_index": 13, "page_start": null, "title": "Enable the optimizer", "short_summary": null, "description_md": "**Description:** [Enable the optimizer](https://dacian.me/the-yieldoor-gas-optimizoor#heading-enabling-the-optimizer) in `foundry.toml`.\n\nGas results:\n```diff\n{\n-  \"addToBlacklist\": \"31090\"\n+  \"addToBlacklist\": \"30691\"\n\n-  \"addToWhitelist\": \"28754\"\n+  \"addToWhitelist\": \"28392\"\n\n-  \"batchAddToBlacklist\": \"60282\"\n+  \"batchAddToBlacklist\": \"59482\"\n\n-  \"batchAddToWhitelist\": \"55790\"\n+  \"batchAddToWhitelist\": \"54997\"\n\n-  \"batchMintAsAdmin\": \"252102\"\n+  \"batchMintAsAdmin\": \"248867\"\n\n-  \"batchRemoveFromBlacklist\": \"5289\"\n+  \"batchRemoveFromBlacklist\": \"4594\"\n\n-  \"batchRemoveFromWhitelist\": \"5305\"\n+  \"batchRemoveFromWhitelist\": \"4677\"\n\n-  \"batchSetAdmin\": \"28090\"\n+  \"batchSetAdmin\": \"27412\"\n\n-  \"mintAsAdmin\": \"130754\"\n+  \"mintAsAdmin\": \"129447\"\n\n-  \"mintAsWhitelisted\": \"135623\"\n+  \"mintAsWhitelisted\": \"132292\"\n\n-  \"mintWithTerms\": \"142281\"\n+  \"mintWithTerms\": \"137638\"\n\n-  \"removeFromBlacklist\": \"2516\"\n+  \"removeFromBlacklist\": \"2203\"\n\n-  \"removeFromWhitelist\": \"2634\"\n+  \"removeFromWhitelist\": \"2254\"\n\n-  \"setAdmin\": \"27187\"\n+  \"setAdmin\": \"26677\"\n\n-  \"setContractURI\": \"29118\"\n+  \"setContractURI\": \"26842\"\n\n-  \"setFeeFactor\": \"26075\"\n+  \"setFeeFactor\": \"25666\"\n\n-  \"setWhitelistEnabled\": \"7175\"\n+  \"setWhitelistEnabled\": \"6902\"\n\n-  \"withdrawFees\": \"14114\"\n+  \"withdrawFees\": \"13462\"\n}\n\n```\n", "full_markdown": "### Enable the optimizer\n\n**Description:** [Enable the optimizer](https://dacian.me/the-yieldoor-gas-optimizoor#heading-enabling-the-optimizer) in `foundry.toml`.\n\nGas results:\n```diff\n{\n-  \"addToBlacklist\": \"31090\"\n+  \"addToBlacklist\": \"30691\"\n\n-  \"addToWhitelist\": \"28754\"\n+  \"addToWhitelist\": \"28392\"\n\n-  \"batchAddToBlacklist\": \"60282\"\n+  \"batchAddToBlacklist\": \"59482\"\n\n-  \"batchAddToWhitelist\": \"55790\"\n+  \"batchAddToWhitelist\": \"54997\"\n\n-  \"batchMintAsAdmin\": \"252102\"\n+  \"batchMintAsAdmin\": \"248867\"\n\n-  \"batchRemoveFromBlacklist\": \"5289\"\n+  \"batchRemoveFromBlacklist\": \"4594\"\n\n-  \"batchRemoveFromWhitelist\": \"5305\"\n+  \"batchRemoveFromWhitelist\": \"4677\"\n\n-  \"batchSetAdmin\": \"28090\"\n+  \"batchSetAdmin\": \"27412\"\n\n-  \"mintAsAdmin\": \"130754\"\n+  \"mintAsAdmin\": \"129447\"\n\n-  \"mintAsWhitelisted\": \"135623\"\n+  \"mintAsWhitelisted\": \"132292\"\n\n-  \"mintWithTerms\": \"142281\"\n+  \"mintWithTerms\": \"137638\"\n\n-  \"removeFromBlacklist\": \"2516\"\n+  \"removeFromBlacklist\": \"2203\"\n\n-  \"removeFromWhitelist\": \"2634\"\n+  \"removeFromWhitelist\": \"2254\"\n\n-  \"setAdmin\": \"27187\"\n+  \"setAdmin\": \"26677\"\n\n-  \"setContractURI\": \"29118\"\n+  \"setContractURI\": \"26842\"\n\n-  \"setFeeFactor\": \"26075\"\n+  \"setFeeFactor\": \"25666\"\n\n-  \"setWhitelistEnabled\": \"7175\"\n+  \"setWhitelistEnabled\": \"6902\"\n\n-  \"withdrawFees\": \"14114\"\n+  \"withdrawFees\": \"13462\"\n}\n\n```\n\n**Evo:**\nFixed in commit [b4fcadb](https://github.com/contractlevel/sbt/commit/b4fcadbd9c5684cc4e3b1ee3c39f72c406aaf658).\n\n**Cyfrin:** Verified.\n", "sections": {"description_md": "**Description:** [Enable the optimizer](https://dacian.me/the-yieldoor-gas-optimizoor#heading-enabling-the-optimizer) in `foundry.toml`.\n\nGas results:\n```diff\n{\n-  \"addToBlacklist\": \"31090\"\n+  \"addToBlacklist\": \"30691\"\n\n-  \"addToWhitelist\": \"28754\"\n+  \"addToWhitelist\": \"28392\"\n\n-  \"batchAddToBlacklist\": \"60282\"\n+  \"batchAddToBlacklist\": \"59482\"\n\n-  \"batchAddToWhitelist\": \"55790\"\n+  \"batchAddToWhitelist\": \"54997\"\n\n-  \"batchMintAsAdmin\": \"252102\"\n+  \"batchMintAsAdmin\": \"248867\"\n\n-  \"batchRemoveFromBlacklist\": \"5289\"\n+  \"batchRemoveFromBlacklist\": \"4594\"\n\n-  \"batchRemoveFromWhitelist\": \"5305\"\n+  \"batchRemoveFromWhitelist\": \"4677\"\n\n-  \"batchSetAdmin\": \"28090\"\n+  \"batchSetAdmin\": \"27412\"\n\n-  \"mintAsAdmin\": \"130754\"\n+  \"mintAsAdmin\": \"129447\"\n\n-  \"mintAsWhitelisted\": \"135623\"\n+  \"mintAsWhitelisted\": \"132292\"\n\n-  \"mintWithTerms\": \"142281\"\n+  \"mintWithTerms\": \"137638\"\n\n-  \"removeFromBlacklist\": \"2516\"\n+  \"removeFromBlacklist\": \"2203\"\n\n-  \"removeFromWhitelist\": \"2634\"\n+  \"removeFromWhitelist\": \"2254\"\n\n-  \"setAdmin\": \"27187\"\n+  \"setAdmin\": \"26677\"\n\n-  \"setContractURI\": \"29118\"\n+  \"setContractURI\": \"26842\"\n\n-  \"setFeeFactor\": \"26075\"\n+  \"setFeeFactor\": \"25666\"\n\n-  \"setWhitelistEnabled\": \"7175\"\n+  \"setWhitelistEnabled\": \"6902\"\n\n-  \"withdrawFees\": \"14114\"\n+  \"withdrawFees\": \"13462\"\n}\n\n```\n", "impact_md": null, "recommendation_md": null, "poc_md": null, "fix_status_md": null, "other_md": "**Evo:**\nFixed in commit [b4fcadb](https://github.com/contractlevel/sbt/commit/b4fcadbd9c5684cc4e3b1ee3c39f72c406aaf658).\n\n**Cyfrin:** Verified.\n", "full_markdown_body": "**Description:** [Enable the optimizer](https://dacian.me/the-yieldoor-gas-optimizoor#heading-enabling-the-optimizer) in `foundry.toml`.\n\nGas results:\n```diff\n{\n-  \"addToBlacklist\": \"31090\"\n+  \"addToBlacklist\": \"30691\"\n\n-  \"addToWhitelist\": \"28754\"\n+  \"addToWhitelist\": \"28392\"\n\n-  \"batchAddToBlacklist\": \"60282\"\n+  \"batchAddToBlacklist\": \"59482\"\n\n-  \"batchAddToWhitelist\": \"55790\"\n+  \"batchAddToWhitelist\": \"54997\"\n\n-  \"batchMintAsAdmin\": \"252102\"\n+  \"batchMintAsAdmin\": \"248867\"\n\n-  \"batchRemoveFromBlacklist\": \"5289\"\n+  \"batchRemoveFromBlacklist\": \"4594\"\n\n-  \"batchRemoveFromWhitelist\": \"5305\"\n+  \"batchRemoveFromWhitelist\": \"4677\"\n\n-  \"batchSetAdmin\": \"28090\"\n+  \"batchSetAdmin\": \"27412\"\n\n-  \"mintAsAdmin\": \"130754\"\n+  \"mintAsAdmin\": \"129447\"\n\n-  \"mintAsWhitelisted\": \"135623\"\n+  \"mintAsWhitelisted\": \"132292\"\n\n-  \"mintWithTerms\": \"142281\"\n+  \"mintWithTerms\": \"137638\"\n\n-  \"removeFromBlacklist\": \"2516\"\n+  \"removeFromBlacklist\": \"2203\"\n\n-  \"removeFromWhitelist\": \"2634\"\n+  \"removeFromWhitelist\": \"2254\"\n\n-  \"setAdmin\": \"27187\"\n+  \"setAdmin\": \"26677\"\n\n-  \"setContractURI\": \"29118\"\n+  \"setContractURI\": \"26842\"\n\n-  \"setFeeFactor\": \"26075\"\n+  \"setFeeFactor\": \"25666\"\n\n-  \"setWhitelistEnabled\": \"7175\"\n+  \"setWhitelistEnabled\": \"6902\"\n\n-  \"withdrawFees\": \"14114\"\n+  \"withdrawFees\": \"13462\"\n}\n\n```\n\n**Evo:**\nFixed in commit [b4fcadb](https://github.com/contractlevel/sbt/commit/b4fcadbd9c5684cc4e3b1ee3c39f72c406aaf658).\n\n**Cyfrin:** Verified.\n", "markdown_raw": "### Enable the optimizer\n\n**Description:** [Enable the optimizer](https://dacian.me/the-yieldoor-gas-optimizoor#heading-enabling-the-optimizer) in `foundry.toml`.\n\nGas results:\n```diff\n{\n-  \"addToBlacklist\": \"31090\"\n+  \"addToBlacklist\": \"30691\"\n\n-  \"addToWhitelist\": \"28754\"\n+  \"addToWhitelist\": \"28392\"\n\n-  \"batchAddToBlacklist\": \"60282\"\n+  \"batchAddToBlacklist\": \"59482\"\n\n-  \"batchAddToWhitelist\": \"55790\"\n+  \"batchAddToWhitelist\": \"54997\"\n\n-  \"batchMintAsAdmin\": \"252102\"\n+  \"batchMintAsAdmin\": \"248867\"\n\n-  \"batchRemoveFromBlacklist\": \"5289\"\n+  \"batchRemoveFromBlacklist\": \"4594\"\n\n-  \"batchRemoveFromWhitelist\": \"5305\"\n+  \"batchRemoveFromWhitelist\": \"4677\"\n\n-  \"batchSetAdmin\": \"28090\"\n+  \"batchSetAdmin\": \"27412\"\n\n-  \"mintAsAdmin\": \"130754\"\n+  \"mintAsAdmin\": \"129447\"\n\n-  \"mintAsWhitelisted\": \"135623\"\n+  \"mintAsWhitelisted\": \"132292\"\n\n-  \"mintWithTerms\": \"142281\"\n+  \"mintWithTerms\": \"137638\"\n\n-  \"removeFromBlacklist\": \"2516\"\n+  \"removeFromBlacklist\": \"2203\"\n\n-  \"removeFromWhitelist\": \"2634\"\n+  \"removeFromWhitelist\": \"2254\"\n\n-  \"setAdmin\": \"27187\"\n+  \"setAdmin\": \"26677\"\n\n-  \"setContractURI\": \"29118\"\n+  \"setContractURI\": \"26842\"\n\n-  \"setFeeFactor\": \"26075\"\n+  \"setFeeFactor\": \"25666\"\n\n-  \"setWhitelistEnabled\": \"7175\"\n+  \"setWhitelistEnabled\": \"6902\"\n\n-  \"withdrawFees\": \"14114\"\n+  \"withdrawFees\": \"13462\"\n}\n\n```\n\n**Evo:**\nFixed in commit [b4fcadb](https://github.com/contractlevel/sbt/commit/b4fcadbd9c5684cc4e3b1ee3c39f72c406aaf658).\n\n**Cyfrin:** Verified.\n"}, "severity": null, "difficulty": null, "type": null, "finding_id": null, "target": {"path": null, "language": null, "chain": null, "contract_name": null, "contract_address": null, "function": null, "bytecode_hash": null, "caip_id": null}, "repo": {"url": "https://github.com/contractlevel/sbt", "org": "contractlevel", "name": "sbt", "commit": "6af531e49f7d7dd525da449bcdbdacb171e0c70d", "branch": null, "relative_file": null, "lines": null}, "taxonomy": {"swc": [], "cwe": [], "tags": []}, "status": {"fix_status": null, "fixed_in_commit": null, "fixed_in_pr": [], "exploited_in_the_wild": null, "cvss": null, "bounty_reference": null}, "references": [], "provenance": {"source_pdf": "2025-06-02-cyfrin-evo-soulboundtoken-v2.0.md", "source_mtime": "2025-11-01T12:05:00+00:00", "report_extracted_at": "2025-11-19T09:22:55.614418+00:00", "report_extractor_version": "poc-0.4-md-no-llm", "report_extraction_tool": "marker+qwen3:8b", "scvd_normalized_at": "2025-11-19T09:22:55.615621+00:00", "scvd_normalizer_version": "poc-0.1"}, "metadata_raw": {"Severity": "Gas", "Difficulty": null, "Type": null, "Finding ID": null, "Target": null, "Severity_normalized": null}}
{"schema_version": "0.1", "scvd_id": "SCVD-cyfrin_2025-06-02-cyfrin-evo-soulboundtoken-v2.0-014", "doc_id": "cyfrin_2025-06-02-cyfrin-evo-soulboundtoken-v2.0", "finding_index": 14, "page_start": null, "title": "Prefer calldata to memory for external read-only inputs", "short_summary": null, "description_md": "**Description:** Prefer `calldata` to `memory` for external read-only inputs:\n```diff\n-   function mintWithTerms(bytes memory signature) external payable returns (uint256 tokenId) {\n+   function mintWithTerms(bytes calldata signature) external payable returns (uint256 tokenId) {\n\n-   function _verifySignature(bytes memory signature) internal view returns (bool) {\n+   function _verifySignature(bytes calldata signature) internal view returns (bool) {\n```\n\nGas results:\n```diff\n{\n-  \"mintWithTerms\": \"137638\"\n+  \"mintWithTerms\": \"137299\"\n}\n```\n", "full_markdown": "### Prefer `calldata` to `memory` for external read-only inputs\n\n**Description:** Prefer `calldata` to `memory` for external read-only inputs:\n```diff\n-   function mintWithTerms(bytes memory signature) external payable returns (uint256 tokenId) {\n+   function mintWithTerms(bytes calldata signature) external payable returns (uint256 tokenId) {\n\n-   function _verifySignature(bytes memory signature) internal view returns (bool) {\n+   function _verifySignature(bytes calldata signature) internal view returns (bool) {\n```\n\nGas results:\n```diff\n{\n-  \"mintWithTerms\": \"137638\"\n+  \"mintWithTerms\": \"137299\"\n}\n```\n\n**Evo:**\nFixed in commit [b4fcadb](https://github.com/contractlevel/sbt/commit/b4fcadbd9c5684cc4e3b1ee3c39f72c406aaf658).\n\n**Cyfrin:** Verified.\n", "sections": {"description_md": "**Description:** Prefer `calldata` to `memory` for external read-only inputs:\n```diff\n-   function mintWithTerms(bytes memory signature) external payable returns (uint256 tokenId) {\n+   function mintWithTerms(bytes calldata signature) external payable returns (uint256 tokenId) {\n\n-   function _verifySignature(bytes memory signature) internal view returns (bool) {\n+   function _verifySignature(bytes calldata signature) internal view returns (bool) {\n```\n\nGas results:\n```diff\n{\n-  \"mintWithTerms\": \"137638\"\n+  \"mintWithTerms\": \"137299\"\n}\n```\n", "impact_md": null, "recommendation_md": null, "poc_md": null, "fix_status_md": null, "other_md": "**Evo:**\nFixed in commit [b4fcadb](https://github.com/contractlevel/sbt/commit/b4fcadbd9c5684cc4e3b1ee3c39f72c406aaf658).\n\n**Cyfrin:** Verified.\n", "full_markdown_body": "**Description:** Prefer `calldata` to `memory` for external read-only inputs:\n```diff\n-   function mintWithTerms(bytes memory signature) external payable returns (uint256 tokenId) {\n+   function mintWithTerms(bytes calldata signature) external payable returns (uint256 tokenId) {\n\n-   function _verifySignature(bytes memory signature) internal view returns (bool) {\n+   function _verifySignature(bytes calldata signature) internal view returns (bool) {\n```\n\nGas results:\n```diff\n{\n-  \"mintWithTerms\": \"137638\"\n+  \"mintWithTerms\": \"137299\"\n}\n```\n\n**Evo:**\nFixed in commit [b4fcadb](https://github.com/contractlevel/sbt/commit/b4fcadbd9c5684cc4e3b1ee3c39f72c406aaf658).\n\n**Cyfrin:** Verified.\n", "markdown_raw": "### Prefer `calldata` to `memory` for external read-only inputs\n\n**Description:** Prefer `calldata` to `memory` for external read-only inputs:\n```diff\n-   function mintWithTerms(bytes memory signature) external payable returns (uint256 tokenId) {\n+   function mintWithTerms(bytes calldata signature) external payable returns (uint256 tokenId) {\n\n-   function _verifySignature(bytes memory signature) internal view returns (bool) {\n+   function _verifySignature(bytes calldata signature) internal view returns (bool) {\n```\n\nGas results:\n```diff\n{\n-  \"mintWithTerms\": \"137638\"\n+  \"mintWithTerms\": \"137299\"\n}\n```\n\n**Evo:**\nFixed in commit [b4fcadb](https://github.com/contractlevel/sbt/commit/b4fcadbd9c5684cc4e3b1ee3c39f72c406aaf658).\n\n**Cyfrin:** Verified.\n"}, "severity": null, "difficulty": null, "type": null, "finding_id": null, "target": {"path": null, "language": null, "chain": null, "contract_name": null, "contract_address": null, "function": null, "bytecode_hash": null, "caip_id": null}, "repo": {"url": "https://github.com/contractlevel/sbt", "org": "contractlevel", "name": "sbt", "commit": "6af531e49f7d7dd525da449bcdbdacb171e0c70d", "branch": null, "relative_file": null, "lines": null}, "taxonomy": {"swc": [], "cwe": [], "tags": []}, "status": {"fix_status": null, "fixed_in_commit": null, "fixed_in_pr": [], "exploited_in_the_wild": null, "cvss": null, "bounty_reference": null}, "references": [], "provenance": {"source_pdf": "2025-06-02-cyfrin-evo-soulboundtoken-v2.0.md", "source_mtime": "2025-11-01T12:05:00+00:00", "report_extracted_at": "2025-11-19T09:22:55.614418+00:00", "report_extractor_version": "poc-0.4-md-no-llm", "report_extraction_tool": "marker+qwen3:8b", "scvd_normalized_at": "2025-11-19T09:22:55.615621+00:00", "scvd_normalizer_version": "poc-0.1"}, "metadata_raw": {"Severity": "Gas", "Difficulty": null, "Type": null, "Finding ID": null, "Target": null, "Severity_normalized": null}}
{"schema_version": "0.1", "scvd_id": "SCVD-cyfrin_2025-06-02-cyfrin-evo-soulboundtoken-v2.0-015", "doc_id": "cyfrin_2025-06-02-cyfrin-evo-soulboundtoken-v2.0", "finding_index": 15, "page_start": null, "title": "Use solady safeTransferETH to send eth", "short_summary": null, "description_md": "**Description:** Using solady [`safeTransferETH`](https://github.com/Vectorized/solady/blob/main/src/utils/SafeTransferLib.sol#L90-L98) is a [more efficient](https://github.com/devdacian/solidity-gas-optimization?tab=readme-ov-file#10-use-safetransferlibsafetransfereth-instead-of-solidity-call-effective-035-cheaper) way to send eth. Also since there is no point in leaving eth inside the contract, consider removing the `amountToWithdraw` input parameter and checks associated with it; instead just send the entire contract balance:\n```solidity\nfunction withdrawFees() external onlyOwner {\n    uint256 amountToWithdraw = address(this).balance;\n    if(amountToWithdraw > 0) {\n        // from https://github.com/Vectorized/solady/blob/main/src/utils/SafeTransferLib.sol#L90-L98\n        /// @solidity memory-safe-assembly\n        assembly {\n            if iszero(call(gas(), caller(), amountToWithdraw, codesize(), 0x00, codesize(), 0x00)) {\n                mstore(0x00, 0xefde920d) // `SoulBoundToken__WithdrawFailed()`.\n                revert(0x1c, 0x04)\n            }\n        }\n\n        emit FeesWithdrawn(amountToWithdraw);\n    }\n}\n```\n\nGas result:\n```diff\n{\n- \"withdrawFees\": \"13462\"\n+ \"withdrawFees\": \"13353\"\n}\n```\n", "full_markdown": "### Use solady `safeTransferETH` to send eth\n\n**Description:** Using solady [`safeTransferETH`](https://github.com/Vectorized/solady/blob/main/src/utils/SafeTransferLib.sol#L90-L98) is a [more efficient](https://github.com/devdacian/solidity-gas-optimization?tab=readme-ov-file#10-use-safetransferlibsafetransfereth-instead-of-solidity-call-effective-035-cheaper) way to send eth. Also since there is no point in leaving eth inside the contract, consider removing the `amountToWithdraw` input parameter and checks associated with it; instead just send the entire contract balance:\n```solidity\nfunction withdrawFees() external onlyOwner {\n    uint256 amountToWithdraw = address(this).balance;\n    if(amountToWithdraw > 0) {\n        // from https://github.com/Vectorized/solady/blob/main/src/utils/SafeTransferLib.sol#L90-L98\n        /// @solidity memory-safe-assembly\n        assembly {\n            if iszero(call(gas(), caller(), amountToWithdraw, codesize(), 0x00, codesize(), 0x00)) {\n                mstore(0x00, 0xefde920d) // `SoulBoundToken__WithdrawFailed()`.\n                revert(0x1c, 0x04)\n            }\n        }\n\n        emit FeesWithdrawn(amountToWithdraw);\n    }\n}\n```\n\nGas result:\n```diff\n{\n- \"withdrawFees\": \"13462\"\n+ \"withdrawFees\": \"13353\"\n}\n```\n\n**Evo:**\nFixed in commit [b4fcadb](https://github.com/contractlevel/sbt/commit/b4fcadbd9c5684cc4e3b1ee3c39f72c406aaf658).\n\n**Cyfrin:** Verified.\n\n\\clearpage\n", "sections": {"description_md": "**Description:** Using solady [`safeTransferETH`](https://github.com/Vectorized/solady/blob/main/src/utils/SafeTransferLib.sol#L90-L98) is a [more efficient](https://github.com/devdacian/solidity-gas-optimization?tab=readme-ov-file#10-use-safetransferlibsafetransfereth-instead-of-solidity-call-effective-035-cheaper) way to send eth. Also since there is no point in leaving eth inside the contract, consider removing the `amountToWithdraw` input parameter and checks associated with it; instead just send the entire contract balance:\n```solidity\nfunction withdrawFees() external onlyOwner {\n    uint256 amountToWithdraw = address(this).balance;\n    if(amountToWithdraw > 0) {\n        // from https://github.com/Vectorized/solady/blob/main/src/utils/SafeTransferLib.sol#L90-L98\n        /// @solidity memory-safe-assembly\n        assembly {\n            if iszero(call(gas(), caller(), amountToWithdraw, codesize(), 0x00, codesize(), 0x00)) {\n                mstore(0x00, 0xefde920d) // `SoulBoundToken__WithdrawFailed()`.\n                revert(0x1c, 0x04)\n            }\n        }\n\n        emit FeesWithdrawn(amountToWithdraw);\n    }\n}\n```\n\nGas result:\n```diff\n{\n- \"withdrawFees\": \"13462\"\n+ \"withdrawFees\": \"13353\"\n}\n```\n", "impact_md": null, "recommendation_md": null, "poc_md": null, "fix_status_md": null, "other_md": "**Evo:**\nFixed in commit [b4fcadb](https://github.com/contractlevel/sbt/commit/b4fcadbd9c5684cc4e3b1ee3c39f72c406aaf658).\n\n**Cyfrin:** Verified.\n\n\\clearpage\n", "full_markdown_body": "**Description:** Using solady [`safeTransferETH`](https://github.com/Vectorized/solady/blob/main/src/utils/SafeTransferLib.sol#L90-L98) is a [more efficient](https://github.com/devdacian/solidity-gas-optimization?tab=readme-ov-file#10-use-safetransferlibsafetransfereth-instead-of-solidity-call-effective-035-cheaper) way to send eth. Also since there is no point in leaving eth inside the contract, consider removing the `amountToWithdraw` input parameter and checks associated with it; instead just send the entire contract balance:\n```solidity\nfunction withdrawFees() external onlyOwner {\n    uint256 amountToWithdraw = address(this).balance;\n    if(amountToWithdraw > 0) {\n        // from https://github.com/Vectorized/solady/blob/main/src/utils/SafeTransferLib.sol#L90-L98\n        /// @solidity memory-safe-assembly\n        assembly {\n            if iszero(call(gas(), caller(), amountToWithdraw, codesize(), 0x00, codesize(), 0x00)) {\n                mstore(0x00, 0xefde920d) // `SoulBoundToken__WithdrawFailed()`.\n                revert(0x1c, 0x04)\n            }\n        }\n\n        emit FeesWithdrawn(amountToWithdraw);\n    }\n}\n```\n\nGas result:\n```diff\n{\n- \"withdrawFees\": \"13462\"\n+ \"withdrawFees\": \"13353\"\n}\n```\n\n**Evo:**\nFixed in commit [b4fcadb](https://github.com/contractlevel/sbt/commit/b4fcadbd9c5684cc4e3b1ee3c39f72c406aaf658).\n\n**Cyfrin:** Verified.\n\n\\clearpage\n", "markdown_raw": "### Use solady `safeTransferETH` to send eth\n\n**Description:** Using solady [`safeTransferETH`](https://github.com/Vectorized/solady/blob/main/src/utils/SafeTransferLib.sol#L90-L98) is a [more efficient](https://github.com/devdacian/solidity-gas-optimization?tab=readme-ov-file#10-use-safetransferlibsafetransfereth-instead-of-solidity-call-effective-035-cheaper) way to send eth. Also since there is no point in leaving eth inside the contract, consider removing the `amountToWithdraw` input parameter and checks associated with it; instead just send the entire contract balance:\n```solidity\nfunction withdrawFees() external onlyOwner {\n    uint256 amountToWithdraw = address(this).balance;\n    if(amountToWithdraw > 0) {\n        // from https://github.com/Vectorized/solady/blob/main/src/utils/SafeTransferLib.sol#L90-L98\n        /// @solidity memory-safe-assembly\n        assembly {\n            if iszero(call(gas(), caller(), amountToWithdraw, codesize(), 0x00, codesize(), 0x00)) {\n                mstore(0x00, 0xefde920d) // `SoulBoundToken__WithdrawFailed()`.\n                revert(0x1c, 0x04)\n            }\n        }\n\n        emit FeesWithdrawn(amountToWithdraw);\n    }\n}\n```\n\nGas result:\n```diff\n{\n- \"withdrawFees\": \"13462\"\n+ \"withdrawFees\": \"13353\"\n}\n```\n\n**Evo:**\nFixed in commit [b4fcadb](https://github.com/contractlevel/sbt/commit/b4fcadbd9c5684cc4e3b1ee3c39f72c406aaf658).\n\n**Cyfrin:** Verified.\n\n\\clearpage\n"}, "severity": null, "difficulty": null, "type": null, "finding_id": null, "target": {"path": null, "language": null, "chain": null, "contract_name": null, "contract_address": null, "function": null, "bytecode_hash": null, "caip_id": null}, "repo": {"url": "https://github.com/contractlevel/sbt", "org": "contractlevel", "name": "sbt", "commit": "6af531e49f7d7dd525da449bcdbdacb171e0c70d", "branch": null, "relative_file": null, "lines": null}, "taxonomy": {"swc": [], "cwe": [], "tags": []}, "status": {"fix_status": null, "fixed_in_commit": null, "fixed_in_pr": [], "exploited_in_the_wild": null, "cvss": null, "bounty_reference": null}, "references": [], "provenance": {"source_pdf": "2025-06-02-cyfrin-evo-soulboundtoken-v2.0.md", "source_mtime": "2025-11-01T12:05:00+00:00", "report_extracted_at": "2025-11-19T09:22:55.614418+00:00", "report_extractor_version": "poc-0.4-md-no-llm", "report_extraction_tool": "marker+qwen3:8b", "scvd_normalized_at": "2025-11-19T09:22:55.615621+00:00", "scvd_normalizer_version": "poc-0.1"}, "metadata_raw": {"Severity": "Gas", "Difficulty": null, "Type": null, "Finding ID": null, "Target": null, "Severity_normalized": null}}
