{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "SCVD Finding v0.1",
  "type": "object",
  "required": ["schema_version", "scvd_id", "doc_id", "finding_index", "title", "provenance"],
  "properties": {
    "schema_version": { "type": "string", "const": "0.1" },
    "scvd_id": { "type": "string", "minLength": 1 },
    "doc_id": { "type": "string", "minLength": 1 },
    "finding_index": { "type": ["integer", "string"] },
    "page_start": { "type": ["integer", "null"] },
    "title": { "type": "string", "minLength": 1 },
    "short_summary": { "type": ["string", "null"] },
    "description_md": { "type": ["string", "null"] },
    "full_markdown": { "type": ["string", "null"] },

    "severity": { "type": ["string", "null"] },
    "difficulty": { "type": ["string", "null"] },
    "type": { "type": ["string", "null"] },
    "finding_id": { "type": ["string", "null"] },

    "target": {
      "type": "object",
      "required": ["path"],
      "properties": {
        "path": { "type": ["string", "null"] },
        "language": { "type": ["string", "null"] },
        "chain": { "type": ["string", "null"] },
        "contract_name": { "type": ["string", "null"] },
        "contract_address": { "type": ["string", "null"] },
        "function": { "type": ["string", "null"] },
        "bytecode_hash": { "type": ["string", "null"] },
        "caip_id": { "type": ["string", "null"] }
      },
      "additionalProperties": false
    },

    "repo": {
      "type": "object",
      "properties": {
        "url": { "type": ["string", "null"] },
        "org": { "type": ["string", "null"] },
        "name": { "type": ["string", "null"] },
        "commit": { "type": ["string", "null"] },
        "branch": { "type": ["string", "null"] },
        "relative_file": { "type": ["string", "null"] },
        "lines": {
          "anyOf": [
            { "type": "null" },
            {
              "type": "array",
              "items": { "type": "integer" },
              "minItems": 2,
              "maxItems": 2
            }
          ]
        }
      },
      "additionalProperties": false
    },

    "taxonomy": {
      "type": "object",
      "properties": {
        "swc": { "type": "array", "items": { "type": "string" } },
        "cwe": { "type": "array", "items": { "type": "string" } },
        "tags": { "type": "array", "items": { "type": "string" } }
      },
      "additionalProperties": false
    },

    "status": {
      "type": "object",
      "properties": {
        "fix_status": { "type": ["string", "null"] },
        "fixed_in_commit": { "type": ["string", "null"] },
        "fixed_in_pr": { "type": "array", "items": { "type": "string" } },
        "exploited_in_the_wild": { "type": ["boolean", "null"] },
        "cvss": { "type": ["string", "number", "object", "null"] },
        "bounty_reference": { "type": ["string", "null"] }
      },
      "additionalProperties": false
    },

    "references": { "type": "array", "items": { "type": "string" } },

    "provenance": {
      "type": "object",
      "required": ["scvd_normalized_at", "scvd_normalizer_version"],
      "properties": {
        "source_pdf": { "type": ["string", "null"] },
        "source_mtime": { "type": ["string", "null"] },
        "report_extracted_at": { "type": ["string", "null"] },
        "report_extractor_version": { "type": ["string", "null"] },
        "report_extraction_tool": { "type": ["string", "null"] },
        "scvd_normalized_at": { "type": "string" },
        "scvd_normalizer_version": { "type": "string" }
      },
      "additionalProperties": false
    },

    "metadata_raw": { "type": ["object", "null"] }
  },
  "additionalProperties": false
}
